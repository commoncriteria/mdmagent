<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../transforms/pp2html.xsl"?>
<PP xmlns="http://common-criteria.rhcloud.com/ns/cc" xmlns:h="http://www.w3.org/1999/xhtml" name="Mobile Device Management Agents">
  <PPReference title="PP Reference" id="ID003">
    <ReferenceTable>
      <PPTitle>Extended Package for Mobile Device Management Agents</PPTitle>
      <PPVersion>2.0</PPVersion>
      <PPAuthor>National Information Assurance Partnership</PPAuthor>
      <PPPubDate>2015-04-13</PPPubDate>
      <PPCertificationID>unassigned</PPCertificationID>
      <CCVersion>Version 3.1</CCVersion>
      <Keywords>Mobile Device Management; MDM; MDM Agents</Keywords>
      <entry>
        <name>Registration</name>
        <description>National Information Assurance Partnership</description>
      </entry>
    </ReferenceTable>
  </PPReference>
  <RevisionHistory role="draft">
    <entry>
      <version>v2.1</version>
      <date>2014-12-04</date>
      <subject>Interim Draft</subject>
    </entry>
  </RevisionHistory>
  <RevisionHistory role="final">
    <entry>
      <version>v 1.0</version>
      <date>2013-10-21</date>
      <subject>Initial Release</subject>
    </entry>
    <entry>
      <version>1.1</version>
      <date>2014-02-07</date>
      <subject>Typographical changes and clarifications to front-matter</subject>
    </entry>
    <entry>
      <version>v 2.0</version>
      <date>2014-12-31</date>
      <subject>Separation of MDM Agent SFRs.<h:br/> Updated cryptography, protocol, X.509
        requirements.<h:br/> Added objective requirement for Agent audit storage.<h:br/> New requirement
        for unenrollment prevention.<h:br/> Initial Release of MDM Agent EP.</subject>
    </entry>
  </RevisionHistory>
  <chapter id="int" title="Introduction">
    <section title="Overview" id="ppoverview"> This Extended Package (EP) describes security
      requirements for a Mobile Device Management (MDM) Agent and is intended to provide a minimal
      baseline set of requirements that are targeted at mitigating well defined and described
      threats. The Agent of an MDM system is only one component of an enterprise deployment of
      mobile devices. Other components, such as the mobile device platforms which enforce the
      security policies, and servers which host mobile application repositories, are out of scope.
      This introduction describes the features of a compliant Target of Evaluation (TOE) and
      discusses how this EP is to be used in conjunction with the MDM Protection Profile (PP) or the
      Mobile Device Fundamentals (MDF) PP. </section>
    <section title="Terms" id="glossary">The following sections provide both Common Criteria and
      technology terms used in this Extended Package. 
        <glossary>
          <entry>
            <term><abbr title="Common Criteria">CC</abbr></term>
            <description>Common Criteria for Information Technology Security
              Evaluation.</description>
          </entry>
          <entry>
            <term><abbr title="Extended Package">EP</abbr></term>
            <description>An implementation-independent set of security requirements for a category
              of products, which extends those in a Protection Profile.</description>
          </entry>
          <entry>
            <term><abbr title="Protection Profile">PP</abbr></term>
            <description>An implementation-independent set of security requirements for a category
              of products.</description>
          </entry>
          <entry>
            <term><abbr title="Security Target">ST</abbr></term>
            <description>A set of implementation-dependent security requirements for a specific
              product.</description>
          </entry>
          <entry>
            <term><abbr title="Target of Evaluation">TOE</abbr></term>
            <description>The product under evaluation. In this case, application software and its
              supporting documentation.</description>
          </entry>
          <entry>
            <term><abbr title="TOE Security Functionality">TSF</abbr></term>
            <description>The security functionality of the product under evaluation.</description>
          </entry>
          <entry>
            <term><abbr title="TOE Summary Specification">TSS</abbr></term>
            <description>A description of how a <abbr linkend="TOE"/> satisfies the SFRs in a <abbr
                linkend="ST"/>. </description>
          </entry>
          <entry>
            <term><abbr title="Security Functional Requirement">SFR</abbr></term>
            <description>A requirement for security enforcement by the <abbr linkend="TOE"/>.
            </description>
          </entry>
          <entry>
            <term><abbr title="Security Assurance Requirement">SAR</abbr></term>
            <description>A requirement to assure the security of the <abbr linkend="TOE"/>.
            </description>
          </entry>
          <entry>
            <term>Mobile Device User (User)</term>
            <description>This is the person who uses and is held responsible for the mobile device’s
              physical control and operation.</description>
          </entry>
          <entry>
            <term>Administrator</term>
            <description>The Administrator is responsible for management activities, including
              setting the policy that is applied by the enterprise on the Mobile Device. This
              administrator is the Mobile Device Management (MDM) Administrator, acting through an
              MDM Agent.</description>
          </entry>
          <entry>
            <term>Operating System (OS)</term>
            <description>Software which runs at the highest privilege level and can directly control
              hardware resources. Modern mobile devices typically have at least two primary
              operating systems: one which runs on the cellular baseband processor and one which
              runs on the application processor. The platform of the application processor handles
              most user interaction and provides the execution environment for apps. The platform of
              the cellular baseband processor handles communications with the cellular network and
              may control other peripherals. The term OS, without context, may be assumed to refer
              to the platform of the application processor.</description>
          </entry>
          <entry>
            <term>Unenrolled state</term>
            <description>The state in which the Mobile Device is not managed by an MDM
              system.</description>
          </entry>
          <entry>
            <term>Enrolled state</term>
            <description>The state in which a Mobile Device is managed by a policy from an MDM
              system.</description>
          </entry>
        </glossary>
    </section>
    <section title="Compliant Targets of Evaluation" id="TOEdescription">The MDM system consists of
      two primary components: the MDM Server software and the MDM Agent.<h:br/> The MDM operational
      environment consists of the mobile device on which the MDM Agent resides, the platform on
      which the MDM Server runs, and an untrusted wireless network over which they communicate, as
      pictured below. <figure entity="images/MDMagentoperatingenvironment.jpg"
        title="Figure 1: MDM System Operating Environment" id="agentoperatingenvironment"/> The MDM
      Agent, which is the focus of this EP, is installed on a mobile device as an application or is
      part of the mobile device’s OS. The MDM Agent establishes a secure connection back to the MDM
      Server controlled by an enterprise administrator. Optionally, the MDM Agent interacts with the
      Mobile Application Store (MAS) Server to download and install enterprise-hosted
      application.<h:br/> The MDM Agent must closely interact with or be part of (as depicted by the
      dotted red/blue line in Figure 1) the mobile device’s platform to establish policies and
      perform queries about device status. The mobile device, in turn, has its own security
      requirements specified in the MDF PP against which the mobile device must be evaluated either
      concurrently with or before the MDM Agent evaluation.<h:br/> If the MDM Agent is part of the
      mobile device’s OS, the agent may present multiple interfaces for configuring the mobile
      device, such as a local interface and a remote interface. Agents conforming to this profile
      must at least offer an interface with a trusted channel that serves as one piece of an MDM
      system. Compliant agents may also offer other interfaces, and the configuration aspects of
      these additional interfaces is in scope of this EP. </section>
    <section title="Use Cases" id="usecases"> </section>
  </chapter>
  <chapter title="Conformance Claims" id="ccl">
    <cclaims>
      <cclaim id="Conformance Statement">
        <description> This EP extends the MDM PP v2.x when the MDM Agent is installed on a mobile
          device as an application that is developed by the MDM developer. This EP extends the MDF
          PP when the MDM Agent is built into the mobile device platform by the mobile device
          vendor.<h:br/> As an EP of either the MDM PP v2.x or the MDF PP v2.x, it is expected that
          the content of this EP and the chosen PP be appropriately combined in the context of each
          product-specific Security Target. This EP has been specifically defined such that there
          should be no difficulty or ambiguity in doing so. When this EP is used with the MDM PP
          v2.x or the MDF PP v2.x, conformant TOEs are obligated to implement the functionality
          required in those PPs with the additional functionality defined in this EP in response to
          the threat environment discussed subsequently herein. An ST must identify the applicable
          versions of the PP chosen and this EP in its conformance claims. <h:br/> This EP serves to
          complement the MDM PP v2.x or the MDF PP v2.x with additional SFRs and associated
          Assurance Activities specific to the MDM Agent. Assurance Activities are the actions that
          the evaluator performs in order to determine a TOE’s compliance to the SFRs. <h:br/> This EP
          conforms to Common Criteria <cite linkend="bibCC"/> for Information Technology Security
          Evaluation, Version 3.1, Revision 4. It is CC Part 2 extended and CC Part 3 conformant. In
          order to be conformant to this EP, the ST must include all components in this EP and the
          associated PP that are: <h:ul><h:li>unconditional (which are always required)</h:li>
            <h:li>selection-based (which are required when certain selections are chosen in the
              unconditional requirements)</h:li></h:ul> and may include optional and/or objective
          components that are desirable but not required for conformance. </description>
      </cclaim>
    </cclaims>
  </chapter>
  <chapter id="spd" title="Security Problem Description">MDM Agents address a range of security
    threats from theft of sensitive data to unauthorized access to malicious application downloads.
    While many of these threats also apply to the MDM Server and the mobile device itself, the MDM
    Agent plays a key role in ensuring the integrity and confidentiality of data is maintained by
    interfacing directly with the OS of the device, either through a 3rd party application or as a
    part of the mobile device OS itself. Applicable threats addressed by the MDM Agent include
    malicious and flawed applications, network attacks, network eavesdropping, and physical
    access.
    <section id="threats" title="Threats">
     <threats>
      <threat id="T.MALICIOUS_APPS">
        <description>Malicious or flawed application (app) threats exist because apps loaded onto a
          Mobile Device may include malicious or exploitable code. This code could be included
          unwittingly by its developer, perhaps as part of a software library. Malicious apps may
          attempt to exfiltrate data to which they have access. Malicious apps may be able to
          control the device's sensors (geolocation, camera, microphone, etc.) to gather
          intelligence about the user's surroundings even when those activities do not involve data
          resident or transmitted from the device. Flawed apps may give an attacker access to
          perform network-based or physical attacks that otherwise would have been prevented.
        </description>
        <objective-refer ref="O.APPLY_POLICY">
          <rationale>The threat T.MALICIOUS_APPS is countered by O.APPLY_POLICY
          </rationale>
        </objective-refer>
      </threat>
      <threat id="T.NETWORK_ATTACK">
        <description>An attacker may position themselves on a wireless communications channel or
          elsewhere on the network infrastructure. From this vantage point, an attacker may initiate
          communication with the mobile device or alter communication between elements of the
          operating environment and other endpoints. By altering this communication, the attacker
          may be able to spoof the MDM Server. </description>
        <objective-refer ref="O.DATA_PROTECTION_TRANSIT">
          <rationale>The threat T.NETWORK_ATTACK is countered by O.DATA_PROTECTION_TRANSIT
          </rationale>
        </objective-refer>
      </threat>
      <threat id="T.NETWORK_EAVESDROP">
        <description>In a similar manner to the network attack threat, an attacker may position
          themselves on a wireless communications channel or elsewhere on the network
          infrastructure. The attacker may then monitor or gain access to data being sent or
          received by the MDM Agent. By monitoring this data, the attacker may intercept security
          critical data including cryptographic keys and human-user authentication data.
        </description>
        <objective-refer ref="O.DATA_PROTECTION_TRANSIT">
          <rationale>The threat T.NETWORK_EAVESDROP is countered by O.DATA_PROTECTION_TRANSIT
          </rationale>
        </objective-refer>
      </threat>
      <threat id="T.PHYSICAL_ACCESS">
        <description>Loss or theft of the underlying mobile device platform may give rise to loss of
          confidentiality of user data, including, most importantly, credentials. Physical access
          attacks involve attempts to access the device through external hardware ports, through its
          user interface, or through direct and possible destructive access to its storage media.
          Such attacks are intended to gain access to data from a lost or stolen mobile device that
          it is not expected to be returned to its owner. Although these attacks are primarily
          directed against the mobile device platform, the MDM Agent configures features which
          address this threat. </description>
        <objective-refer ref="O.APPLY_POLICY">
          <rationale>The threat T.PHYSICAL_ACCESS is countered by O.APPLY_POLICY
          </rationale>
        </objective-refer>
      </threat>
     </threats>
    </section>
    <section title="Assumptions" id="assumptions"> The specific conditions listed below are assumed
      to exist in the TOE’s Operational Environment. These include both practical realities in the
      development of the TOE security requirements and the essential environmental conditions on the
      use of the TOE. 
      <assumptions>
        <assumption id="A.MOBILE_DEVICE_PLATFORM">
          <description> The MDM Agent relies upon Mobile platform and hardware evaluated against the
            MDFPP and assured to provide policy enforcement as well as cryptographic services and
            data protection. The Mobile platform provides trusted updates and software integrity
            verification of the MDM Agent. </description>
          <objective-refer ref="OE.MOBILE_DEVICE_PLATFORM">
            <rationale>The operational environment objective OE.MOBILE_DEVICE_PLATFORM is realized through
              A.MOBILE_DEVICE_PLATFORM.</rationale>
          </objective-refer>
        </assumption>
        <assumption id="A.PROPER_ADMIN">
          <description>One or more competent, trusted personnel who are not careless, willfully
            negligent, or hostile, are assigned and authorized as the TOE Administrators, and do so
            using and abiding by guidance documentation. </description>
          <objective-refer ref="OE.PROPER_ADMIN">
            <rationale>The operational environment objective OE.PROPER_ADMIN is realized through
              A.PROPER_ADMIN.</rationale>
          </objective-refer>
        </assumption>
        <assumption id="A.PROPER_USER">
          <description>Mobile device users are not willfully negligent or hostile, and use the
            device within compliance of a reasonable Enterprise security policy. </description>
          <objective-refer ref="OE.PROPER_USER">
            <rationale>The operational environment objective OE.PROPER_USER is realized through
              A.PROPER_USER.</rationale>
          </objective-refer>
        </assumption>
        <assumption id="A.CONNECTIVITY">
          <description>The TOE relies on network connectivity to carry out its management
            activities. The TOE will robustly handle instances when connectivity is unavailable or
            unreliable. </description>
          <objective-refer ref="OE.WIRELESS_NETWORK">
            <rationale>The operational environment objective OE.WIRELESS_NETWORK is realized through
              A.CONNECTIVITY.</rationale>
          </objective-refer>
        </assumption>
      </assumptions>
    </section>
    <section title="Organizational Security Policies" id="OSPs">
      <OSPs>
        <OSP id="P.ADMIN">
          <description>The configuration of the mobile device security functions must adhere to the
            Enterprise security policy.</description>
          <objective-refer ref="OE.PROPER_ADMIN">
            <rationale>The organizational security policy P.ADMIN is realized through
              OE.PROPER_ADMIN.</rationale>
          </objective-refer>
        </OSP>
        <OSP id="P.DEVICE_ENROLL">
          <description>A mobile device must be enrolled for a specific user by the administrator of
            the MDM prior to being used in the Enterprise network by the user.</description>
          <objective-refer ref="OE.IT_ENTERPRISE">
            <rationale>The organizational security policy P.DEVICE_ENROLL is realized through
              OE.IT_ENTERPRISE.</rationale>
          </objective-refer>
        </OSP>
        <OSP id="P.NOTIFY">
          <description>The mobile user must immediately notify the administrator if a mobile device
            is lost or stolen so that the administrator may apply remediation actions via the MDM
            system.</description>
          <objective-refer ref="OE.PROPER_USER">
            <rationale>The organizational security policy P.NOTIFY is realized through
              OE.PROPER_USER.</rationale>
          </objective-refer>
        </OSP>
        <OSP id="P.ACCOUNTABILITY">
          <description>Personnel operating the TOE shall be accountable for their actions within the
            TOE.</description>
          <objective-refer ref="O.ACCOUNTABILITY">
            <rationale>The organizational security policy O.ACCOUNTABILITY is realized through
              P.ACCOUNTABILITY.</rationale>
          </objective-refer>
        </OSP>
      </OSPs>
    </section>
  </chapter>

  <chapter title="Security Objectives" id="sobj"> Compliant TOEs will provide security functionality
    and implement policies that address threats to the enterprise from inclusion of mobile devices.
    The following sections provide a description of this functionality in light of the threats
    previously discussed. The security functionality provided includes protected communications to
    and from the MDM Agent, configuration of security policies for mobile devices, and system
    reporting for detection of security relevant events. <section
      title="Security Objectives for the TOE" id="SecurityObjectivesTOE">
      <SOs>
        <SO id="O.DATA_PROTECTION_TRANSIT">
          <description>To address the issues concerning transmitting sensitive data to and from the
            MDM Agent described in Section 2.1.3, compliant TOEs will use a trusted communication
            path. The trusted channel to and from the MDM Agent is implemented using one (or more)
            of these standard protocols: DTLS, HTTPS, or TLS.<h:br/> To address the threat of network
            attacks described in Section 2.1.2, the protocols described in this document provide
            encryption and mutual authentication to and from the MDM Agent in a cryptographically
            secure manner; thus, any attempt by a malicious attacker to represent himself to the MDM
            Agent as a MDM Server would be detected.</description>
          <component-refer ref="FCS_STG_EXT.4"/>
          <component-refer ref="FCS_STG_EXT.1(2)"/>
          <component-refer ref="FTP_ITC_EXT.1"/>
          <component-refer ref="FPT_ITT_EXT.1"/>
          <component-refer ref="FCS_TLSC_EXT.1"/>
          <component-refer ref="FIA_ENR_EXT.2"/>
        </SO>
        <SO id="O.ACCOUNTABILITY">
          <description>To ensure that information exists that allows administrators to discover
            unintentional issues with the configuration and operation of the mobile device,
            compliant TOEs have the capability of generating reports which may indicate such issues.
            Auditing of administrative activities provides information that may hasten corrective
            action.</description>
          <component-refer ref="FAU_ALT_EXT.2"/>
          <component-refer ref="FAU_GEN.1"/>
          <component-refer ref="FAU_SEL.1"/>
          <component-refer ref="FAU_STG_EXT.1"/>
        </SO>
        <SO id="O.APPLY_POLICY">
          <description>Mobile devices can accept security policies defined by the Enterprise in
            order to ensure protection of enterprise data that they may store or process. The MDM
            Agent is responsible for interacting with the mobile device platform to establish
            policies and execute commands from the MDM Server, and sending reports to the MDM
            Server.</description>
          <component-refer ref="FMT_SMF_EXT.3"/>
          <component-refer ref="FMT_UNR_EXT.1"/>
          <component-refer ref="FMT_POL_EXT.2"/>
        </SO>
      </SOs>
    </section>
    <section title="Security Objectives for the Operational Environment"
      id="SecurityObjectivesTOEorEnvironment">The following security objectives for the operational
      environment assist the <abbr linkend="TOE"/> in correctly providing its security
      functionality. These track with the assumptions about the environment. <SOEs>
        <SOE id="OE.IT_ENTERPRISE">
          <description>The MDM Agent relies upon the trustworthy Mobile platform and hardware to
            provide policy enforcement as well as cryptographic services and data protection. The
            Mobile platform provides trusted updates and software integrity verification of the MDM
            Agent.</description>
        </SOE>
        <SOE id="OE.MOBILE_DEVICE_PLATFORM">
          <description>The MDM Agent relies upon the trustworthy Mobile platform and hardware to
            provide policy enforcement as well as cryptographic services and data protection. The
            Mobile platform provides trusted updates and software integrity verification of the MDM
            Agent.</description>
        </SOE>
        <SOE id="OE.PROPER_ADMIN">
          <description>TOE Administrators are trusted to follow and apply all administrator guidance
            in a trusted manner.</description>
        </SOE>
        <SOE id="OE.PROPER_USER">
          <description>Users of the mobile device are trained to securely use the mobile device and
            apply all guidance in a trusted manner.</description>
        </SOE>
        <SOE id="OE.WIRELESS_NETWORK">
          <description>A wireless network will be available to the mobile devices.</description>
        </SOE>
      </SOEs></section>
    <section title="Security Objectives Rationale" id="SOR">This section describes how the
      assumptions, threats, and organizational security policies map to the security objectives.
      <InsertSPDCorrespondence/>
    </section>
  </chapter>


  <chapter title="Security Requirements" id="req">This chapter describes the security requirements
    which have to be fulfilled by the <abbr linkend="TOE"/>. Those requirements comprise functional
    components from Part 2 and assurance components from Part 3 of <cite linkend="bibCC"/>. The
    following notations are used: <h:ul>
      <h:li>
        <h:b>Refinement</h:b> operation (denoted by <h:b>bold text</h:b>): is used to add details to a
        requirement, and thus further restricts a requirement.</h:li>
      <h:li>
        <h:b>Selection</h:b> (denoted by <h:i>italicized text</h:i>): is used to select one or more options
        provided by the [CC] in stating a requirement.</h:li>
      <h:li>
        <h:b>Assignment</h:b> operation (denoted by <h:i>italicized text</h:i>): is used to assign a
        specific value to an unspecified parameter, such as the length of a password. Showing the
        value in square brackets indicates assignment.</h:li>
      <h:li>
        <h:b>Iteration</h:b> operation: are identified with a number inside parentheses (e.g.
        "(1)")</h:li>
      <h:li>Extended SFRs are identified by having a label ‘EXT’ after the requirement name for TOE
        SFRs.</h:li>
    </h:ul>

  <section id="testEnvironment" title="Test Environment for Assurance Activities"> The Test
      Environment for the assurance activities of the SFRs for MDM Agents differs based on whether
      the Agent EP extends the MDM PP or the MDF PP.<h:br/> If the EP extends the MDM PP, the
      assurance activities shall be performed using the MDM Server in evaluation against the base
      MDM PP, and many of the assurance activities in this EP may be combined with the assurance
      activities in the MDM PP.<h:br/> If the EP extends the MDF PP, the assurance activities shall be
      performed with a test MDM Server that is capable of exercising all of the functionality of the
      Agent. This test server is not required to be a commercial product and may be provided by the
      mobile device vendor as a tool for testing only. A number of the assurance activities in this
      EP may be combined with assurance activities in the MDF PP. </section>
  <section id="sfrDirection" title="MDF PP Security Functional Requirement Direction">If this EP
      is extending the MDF PP, the Agent is expected to utilize a number of security functions
      implemented by the mobile device and evaluated against the base PP. This security
      functionality includes FCS_CKM.1, FCS_CKM.2, FCS_CKM_EXT.4, FCS_COP.1(*), FCS_RBG_EXT.1,
      FCS_TLSC_EXT.2, FIA_X509_EXT.1, FIA_X509_EXT.2, FIA_X509_EXT.3, FPT_TST_EXT.2, FCS_DTLS_EXT.1,
      and FCS_HTTPS_EXT.1. 
    <subsection id="fcs" title="Cryptographic Support (FCS)">
        <f-component id="FCS_STG_EXT.4" name="Cryptographic Key Storage" status="threshold">
	  <note>
	  The following requirement
          is identical, except in name, to the Cryptographic Key Storage requirement for EPs
          extending the MDM PP. The names differ for clarity, and one must be added to the Agent’s
          ST depending on the base PP.
	  </note>
          <f-element id="FCS_STG_EXT.4.1">
            <title>The MDM Agent shall store persistent secrets and private keys when not in use in
              platform-provided key storage.</title>
            <note role="application">This requirement ensures that persistent secrets (credentials,
              secret keys) and private keys are stored securely when not in use by the mobile
              platform.</note>
            <aactivity>
              <tss>The evaluator will verify that the TSS lists each persistent secret
              (credential, secret key) and private key needed to meet the requirements in the ST.
              For each of these items, the evaluator will confirm that the TSS lists for what
              purpose it is used, and, for each platform listed as supported in the ST, how it is
              stored. The evaluator shall verify that the Agent calls a platform-provided API to
              store persistent secrets and private keys.
              </tss>
            </aactivity>
          </f-element>
        </f-component>
      </subsection>
      <subsection id="ftp" title="Trusted Path/Channels(FTP)">
        <h:b>Trusted Channel Communication</h:b><h:br/>
        <f-component id="FTP_ITC_EXT.1" name="Trusted Channel Communication" status="threshold"> 
	  <note>If the EP extends the
          MDF PP, the communication channel between the Agent and the Server is external to the TOE
          and FTP_ITC_EXT.1 in the MDF PP should be modified as below. 
	  </note>
          <f-element id="FTP_ITC_EXT.1.1">
            <title>The TSF shall use 802.11-2012, 802.1X, and EAP-TLS and at least one of:
            <selectables linebreak="yes">
              <selectable>IPsec</selectable>
              <selectable>TLS</selectable>
              <selectable>DTLS</selectable>
              <selectable>HTTPS protocol</selectable>
            </selectables> to provide a communication channel between itself and another trusted
              IT product that is logically distinct from other communication channels, provides
              assured identification of its end points, protects channel data from disclosure, and
              detects modification of the channel data.</title>
            <note role="application"> This requirement is inherited from the base PP; the mobile
              device is required to perform the mandated cryptographic protocols as in the base PP
              for communication channels mandated in the MDF PP. The ST author must select one of
              TLS, DTLS, or HTTPS in order to establish and maintain a trusted channel between the
              TOE and the MDM Server. Only TLS, DTLS, or HTTPS are used in this trusted
              channel.<h:br/> This requirement is to ensure that the transmission of any audit logs,
              mobile device information data (software version, hardware model, and application
              versions), and configuration data collected by the MDM Agent and sent from the MDM
              Agent to the MDM Server, when commanded, or at configurable intervals, is properly
              protected. This trusted channel also protects any commands and policies sent by the
              MDM Server to the MDM Agent. Either the MDM Agent or the MDM Server is able to
              initiate the connection.<h:br/> This trusted channel protects both the connection
              between an enrolled MDM Agent and the MDM Server and the connection between an
              unenrolled MDM Agent and the MDM Server during the enrollment operation. Different
              protocols can be used for these two connections, and the description in the TSS should
              make this difference clear.<h:br/> The trusted channel uses TLS, DTLS, or HTTPS as the
              protocol that preserves the confidentiality and integrity of MDM communications. The
              ST author chooses the mechanism or mechanisms supported by the TOE, and then ensures
              the detailed requirements in Appendix C corresponding to their selection are copied to
              the ST if not already present.<h:br/> Protocol, RBG, Certificate validation, algorithm,
              and similar services may be met with platform provided services. </note>
          </f-element>
          <f-element id="FTP_ITC_EXT.1.2">
            <title>The TSF shall permit the TSF and the MDM Server and <selectables>
              <selectable>MAS Server</selectable>
              <selectable>no other IT entities</selectable>
            </selectables> to initiate communication via the trusted channel.</title>
            <note role="application">For all other use cases, the mobile device initiates the
              communication; however, for MDM Agents, the MDM Server may also initiate
              communication. This requirement replaces the requirement in the MDF PP.</note>
          </f-element>
          <f-element id="FTP_ITC_EXT.1.3">
            <title>The TSF shall initiate communication via the trusted channel for wireless access
              point connections, administrative communication, configured enterprise connections,
              and <selectables>
                <selectable>OTA updates</selectable>
                <selectable>no other connections</selectable>
              </selectables>.</title>
            <note role="application">This element is inherited from the MDF PP; it is expected that
              Mobile Device will initiate the trusted channel between the MDM Agent and the MDM
              Server for administrative communication and may initiate other trusted channels to
              other trusted IT entities for other uses.</note>
            <aactivity>The following additional assurance activities shall be performed.
              <tss>
              The evaluator shall examine the TSS to determine that the methods of
              Agent-Server communication are indicated, along with how those communications are
              protected. The evaluator shall also confirm that all protocols listed in the TSS in
              support of remote TOE administration are consistent with those specified in the
              requirement, and are included in the requirements in the ST. 
              </tss>
              <guidance>
              The evaluator shall confirm that the operational guidance contains instructions for
              configuring the communication channel between the MDM Agent and the MDM Server and
              conditionally, the MAS Server for each supported method.
              </guidance>
              <tests>
              For a MDM Server and, conditionally, a MAS Server: 
              <testlist>
                <test>The evaluators shall ensure that communications using each specified (in the
                  operational guidance) Agent-Server communication method is tested during the
                  course of the evaluation, setting up the connections as described in the
                  operational guidance and ensuring that communication is successful.</test>
                <test>The evaluator shall ensure, for each method of Agent-Server communication, the
                  channel data is not sent in plaintext.</test>
                <test>The evaluator shall ensure, for each communication channel with the MDM
                  Server, that a protocol analyzer identifies the traffic as the protocol under
                  testing.</test>
              </testlist>
              </tests>
                  Further assurance activities are associated with the specific protocols.
            </aactivity>
          </f-element>
        </f-component>
      </subsection>
    </section>
  <section id="mdmsfrdDirection" title="MDM PP Security Functional Requirement Direction">If this
      EP is extending the MDM PP, the Agent is part of the MDM TOE and any requirements on the MDM
      TOE also apply to the MDM Agent. These security functions includes FCS_CKM.1, FCS_CKM.2,
      FCS_CKM_EXT.4, FCS_COP.1(*), FCS_RBG_EXT.1, FIA_X509_EXT.1, FIA_X509_EXT.2, FIA_X509_EXT.3,
      FIA_X509_EXT.4, FPT_TST_EXT.2, FCS_DTLS_EXT.1, and FCS_HTTPS_EXT.1. The ST author should
      iterate the requirements in the MDM PP for each Agent in order to make the appropriate
      selections for each agent. 
    <subsection id="cryptofcs" title="Cryptographic Support (FCS)">
        <f-component id="FCS_STB_EXT.1" name="Cryptographic Key Storage" status="threshold">
	  <note>
	    The following requirement is identical, except in name, to the Cryptographic Key Storage requirement for EPs
            extending the MDF PP.
	    The names differ for clarity and one must be added to the Agent’s ST
            depending on the base PP.
	  </note>
          <f-element id="FCS_STG_EXT.1.1(2)">
            <title>The MDM Agent shall store persistent secrets and private keys when not in use in
              platform-provided key storage.</title>
            <note role="application">This requirement ensures that persistent secrets (credentials,
              secret keys) and private keys are stored securely when not in use by the mobile
              platform.</note>
            <aactivity>
             <tss>
              The evaluator will verify that the TSS lists each persistent secret
              (credential, secret key) and private key needed to meet the requirements in the ST.
              For each of these items, the evaluator will confirm that the TSS lists for what
              purpose it is used, and, for each platform listed as supported in the ST, how it is
              stored. The evaluator shall verify that the Agent calls a platform-provided API to
              store persistent secrets and private keys. 
             </tss>    
            </aactivity>
          </f-element>
        </f-component>
        <f-component id="FCS_TLSC_EXT.1" name="TLS Client Protocol" status="threshold">
	  <note>
	    The ST author shall include the FCS_TLSC_EXT.1 requirement from the Optional Requirements in the MDM PP.
	  </note>
	</f-component>
     </subsection>
    <subsection id="protection" title="Protection of the TSF (FPT)"> If the EP extends the MDM PP,
        the communication channel between the Agent and the Server is internal to the TOE and is
        addressed by FPT_ITT.1 in the MDM PP.
     </subsection>
   </section>
    
  <section title="Security Functional Requirements" id="SFRs">The Security Functional Requirements
      included in this section are derived from Part 2 of the Common Criteria for Information
      Technology Security Evaluation, Version 3.1, Revision 4, with additional extended functional
      components. 
      <subsection id="fau" title="Security Audit (FAU)">
        <f-component id="FAU_ALT_EXT.2" name="Agent Alerts" status="threshold">
          <f-element id="FAU_ALT_EXT.2.1">
            <title>The MDM Agent shall provide an alert via the trusted channel to the MDM Server in
              the event of any of the following: <!-- HERE fix this list -->
              <h:ol type="a">
                <h:li>successful application of policies to a mobile device</h:li>
                <h:li>
                  <selectables>
                    <selectable>receiving</selectable>
                    <selectable>generating</selectable>
                  </selectables> periodic reachability events; </h:li>
                <selectables linebreak="yes">
                  <selectable>change in enrollment state</selectable>
                  <selectable>failure to install an application from the MAS
                    Server</selectable>
                  <selectable>failure to update an application from the MAS
                    Server</selectable>
                  <selectable><assignable>other events</assignable>, no other
                    events</selectable>
                </selectables>
              </h:ol>
            </title>
            <note role="application"> The trusted channel is defined in FPT_ITT.1. “Alert” in this
              requirement could be as simple as an audit record or a notification.<h:br/> This
              requirement is to ensure that the MDM Agent shall notify the MDM Server whenever one
              of the events listed above occurs. Lack of receipt of a successful policy installation
              indicates the failure of the policy installation.<h:br/> The periodic reachability
              events ensure that either the MDM Agent responds to MDM Server polls to determine
              device network reachability, or the MDM Agent can be configured to regularly notify
              the Server that it is reachable. The ST author must select “receiving” in the first
              case and “generating” in the second. The corresponding requirement for the MDM Server
              is FAU_NET_EXT.1 in the MDM PP.<h:br/> The ST author must either assign further events
              or select the “no other events” option. Note that alerts may take time to reach the
              MDM Server, or not arrive, due to poor connectivity. </note>
            <aactivity>
              <tss>The evaluator shall examine the TSS and verify that it describes how the
              alerts are implemented.<h:br/> The evaluator ensures that the TSS describes how the
              candidate policy updates are obtained; and the actions that take place for successful
              (policy update installed) and unsuccessful (policy update not installed) cases. The
              software components that are performing the processing must also be identified in the
              TSS and verified by the evaluator.<h:br/> The evaluator also ensures that the TSS
              describes how reachability events are implemented, and if configurable are selected in
              <linkref linkend="FMT_SMF_EXT.3.2"/>. The evaluator verifies that this description
              clearly indicates who (MDM Agent or MDM Server) initiates reachability events.
              </tss>
              <tests>
              <testlist>
                <test>The evaluator shall perform a policy update from the test environment MDM
                  server. The evaluator shall verify the MDM Agent accepts the update, makes the
                  configured changes, and reports the success of the policy update back to the MDM
                  Server.</test>
                <test>The evaluator shall perform each of the actions listed in FAU_ALT_EXT.1.1 and
                  verify that the alert does in fact reach the MDM Server.</test>
                <test>The evaluator shall configure the MDM Agent to perform a network reachability
                  test, both with and without such connectivity and ensure that results reflect
                  each.</test>
              </testlist>
              </tests>
            </aactivity>
          </f-element>
          <f-element id="FAU_ALT_EXT.2.2">
            <title>The MDM Agent shall queue alerts if the trusted channel is not available.</title>
            <aactivity>
              <tss>The evaluator shall ensure that the TSS describes under what
              circumstances, if any, the alert may not be generated (e.g., the device is powered off
              or disconnected from the trusted channel), how alerts are queued, and the maximum
              amount of storage for queued messages. 
              </tss>
              <tests>The evaluator shall remove
              network connectivity from the MDM Agent and generate an alert/event in
              <linkref linkend="FAU_ALT_EXT.2.1"/>. The evaluator shall restore network
              connectivity to the MDM Agent and verify that the alert generated while the
              TOE was disconnected is sent by the MDM Agent.
              </tests>
            </aactivity>
          </f-element>
        </f-component>     
        <f-component id="FAU_GEN.1"  name="Audit Data Generation" status="objective">
          <!-- TOE - FAU_GEN.1.2(2) -->
          <f-element id="FAU_GEN.1.1(2)">
            <title> Refinement: The MDM Agent shall be able to generate an MDM Agent audit record of
              the following auditable events: <h:ul>
                <h:li>Start-up and Shutdown of the audit functions;</h:li>
                <h:li>Change in MDM policy; and</h:li>
                <h:li>Any modification commanded by the MDM Server,</h:li>
                <h:li>Specifically defined auditable events listed in Table 7</h:li>
                <h:li><assignable>other events</assignable></h:li>
              </h:ul>
            </title>
            <note role="application"> This requirement is added to the ST if the MDM Agent has the
              functionality to generate audit records. This requirement outlines the information to
              be included in the MDM Agent’s audit records. The ST author can include other
              auditable events directly in the table in FAU_GEN.1.1; they are not limited to the
              list presented.<h:br/> The change of the MDM policy must minimally indicate that the
              policy changed. The event record need not contain the differences between the prior
              policy and the new policy. Modifications commanded by the MDM Server are those
              commands listed in FMT_SMF.1.1. </note>
            <aactivity>
              <tss>The evaluator shall check the TSS and ensure that it provides a format for
              audit records. Each audit record format type must be covered, along with a brief
              description of each field.
              </tss>
              <h:h4>Tests</h:h4> The evaluator shall test the TOE’s ability
              to correctly generate audit records by having the TOE generate audit records for the
              events listed and administrative actions. When verifying the test results, the
              evaluator shall ensure the audit records generated during testing match the format
              specified in the administrative guide, and that the fields in each audit record have
              the proper entries.<h:br/> Note that the testing here can be accomplished in conjunction
              with the testing of the security mechanisms directly.<h:br/>
              <h:center><h:h4>Table 7: Auditable Events</h:h4></h:center>
              <h:table>
                <h:TR>
                  <h:TH>Requirement</h:TH>
                  <h:TH>Auditable Events</h:TH>
                  <h:TH>Additional Audit Record Contents</h:TH>
                </h:TR>
                <h:TR>
                  <h:TD>FAU_ALT_EXT.2</h:TD>
                  <h:TD>Type of alert.</h:TD>
                  <h:TD>No additional information.</h:TD>
                </h:TR>
                <h:TR>
                  <h:TD>FAU_GEN.1</h:TD>
                  <h:TD>None.</h:TD>
                  <h:TD/>
                </h:TR>
                <h:TR>
                  <h:TD>FAU_SEL.1</h:TD>
                  <h:TD>All modifications to the audit configuration that occur while the audit
                    collection functions are operating.</h:TD>
                  <h:TD>No additional information.</h:TD>
                </h:TR>
                <h:TR>
                  <h:TD>FAU_STG_EXT.1</h:TD>
                  <h:TD>None.</h:TD>
                  <h:TD/>
                </h:TR>
                <h:TR>
                  <h:TD>FCS_STG_EXT.4.1/<h:br/>FCS_STG_EXT.1(1)</h:TD>
                  <h:TD>None.</h:TD>
                  <h:TD/>
                </h:TR>
                <h:TR>
                  <h:TD>FCS_TLSC_EXT.1</h:TD>
                  <h:TD>Failure to establish a TLS session.<h:br/>Failure to verify presented
                    identifier.<h:br/>Establishment/termination of a TLS session.</h:TD>
                  <h:TD>Reason for failure.<h:br/>Presented identifier and reference
                    identifier.<h:br/>Non-TOE endpoint of connection.</h:TD>
                </h:TR>
                <h:TR>
                  <h:TD>FIA_ENR_EXT.2</h:TD>
                  <h:TD>Enrollment in management.</h:TD>
                  <h:TD>Reference identifier of MDM Server.</h:TD>
                </h:TR>
                <h:TR>
                  <h:TD>FMT_POL_EXT.2</h:TD>
                  <h:TD>Failure of policy validation.</h:TD>
                  <h:TD>Reason for failure of validation.</h:TD>
                </h:TR>
                <h:TR>
                  <h:TD>FMT_SMF_EXT.3</h:TD>
                  <h:TD>Success or failure of function.</h:TD>
                  <h:TD>No additional information.</h:TD>
                </h:TR>
                <h:TR>
                  <h:TD>FMT_UNR_EXT.1.1</h:TD>
                  <h:TD>Attempt to unenroll.</h:TD>
                  <h:TD>No additional information.</h:TD>
                </h:TR>
                <h:TR>
                  <h:TD>FTP_ITC_EXT.1/<h:br/>FPT_ITT_EXT.1</h:TD>
                  <h:TD>Initiation and termination of trusted channel.</h:TD>
                  <h:TD>Trusted channel protocol. Non-TOE endpoint of connection.</h:TD>
                </h:TR>
              </h:table>
            </aactivity>
          </f-element>
          <!-- TOE or TOE PLATFORM - FAU_GEN.1.2(2) -->
          <f-element id="FAU_GEN.1.2(2)">
            <title>Refinement: The <selectables>
              <selectable>TSF</selectable>
              <selectable>TOE platform</selectable>
            </selectables> shall record within each MDM Agent audit record at least the following
              information: <h:ul>
                <h:li>date and time of the event</h:li>
                <h:li>type of event</h:li>
                <h:li>subject identity</h:li>
                <h:li>(if relevant) the outcome (success or failure) of the event</h:li>
                <h:li>additional information in Table 7</h:li>
                <h:li><assignable>other audit relevant information</assignable></h:li>
              </h:ul></title>
            <note role="application">All audits must contain at least the information mentioned in
              FAU_GEN.1.2(2), but may contain more information which can be assigned. The ST author
              shall identify in the TSS which information of the audit record that is performed by
              the MDM Agent and that which is performed by the MDM Agent’s platform.</note>
            <aactivity>
              <tss>The evaluator shall check the TSS and ensure that it provides a format for
              audit records. Each audit record format type must be covered, along with a brief
              description of each field.
              </tss>
              <h:h4>Tests</h:h4>When verifying the test results, the
              evaluator shall ensure the audit records generated during testing match the format
              specified in the administrative guide, and that the fields in each audit record have
              the proper entries.<h:br/> Note that the testing here can be accomplished in conjunction
              with the testing of the security mechanisms directly. </aactivity>
          </f-element>
        </f-component>
        <f-component id="FAU_SEL.1" name="Security Audit Event Selection" status="objective">
          <f-element id="FAU_SEL.1.1(2)">
            <title>The TSF shall be able to select the set of events to be audited from the set of
              all auditable events based on the following attributes: <h:ol type="a">
                <h:li>event type;</h:li>
                <h:li>success of auditable security events;</h:li>
                <h:li>failure of auditable security events; and</h:li>
                <h:li><assignable>other attributes</assignable></h:li>
              </h:ol></title>
            <note role="application">The intent of this requirement is to identify all criteria that
              can be selected to trigger an audit event. For the ST author, the assignment is used
              to list any additional criteria or “none”. This selection may be configured by the MDM
              Server.</note>
            <aactivity>
              <guidance>The evaluator shall review the administrative guidance to ensure that
              the guidance itemizes all event types, as well as describes all attributes that are to
              be selectable in accordance with the requirement, to include those attributes listed
              in the assignment. The administrative guidance shall also contain instructions on how
              to set the pre-selection as well as explain the syntax (if present) for multi-value
              pre-selection. The administrative guidance shall also identify those audit records
              that are always recorded, regardless of the selection criteria currently being
              enforced.
              </guidance>
              <tests>
              <testlist>
                <test>For each attribute listed in the requirement, the evaluator shall devise a
                  test to show that selecting the attribute causes only audit events with that
                  attribute (or those that are always recorded, as identified in the administrative
                  guidance) to be recorded.</test>
                <test>[conditional]: If the TSF supports specification of more complex audit
                  pre-selection criteria (e.g., multiple attributes, logical expressions using
                  attributes) then the evaluator shall devise tests showing that this capability is
                  correctly implemented. The evaluator shall also, in the test plan, provide a short
                  narrative justifying the set of tests as representative and sufficient to exercise
                  the capability.</test>
              </testlist>
              </tests>
            </aactivity>
          </f-element>
        </f-component>
        <f-component id="FAU_STG_EXT.1" name="Security Audit Event Storage" status="objective">
          <f-element id="FAU_STG_EXT.1.1"> 
            <title>The MDM Agent shall store MDM audit records in the platform-provided audit
              storage.</title>
            <aactivity>
              <tss>The evaluator will verify that the TSS description of the audit records
              indicates how the records are stored. The evaluator shall verify that the Agent calls
              a platform-provided API to store audit records.
              </tss>
            </aactivity>
          </f-element>
        </f-component> 
      </subsection>
      <subsection id="fia" title="Identification and Authentication (FIA)">
        <f-component id="FIA_ENR_EXT.2" name="Enrollment of Mobile Device into Management" status="threshold">
          <f-element id="FIA_ENR_EXT.2.1">
            <title>The MDM Agent shall record the reference identifier of the MDM Server during the
              enrollment process.</title>
            <note role="application">The reference identifier of the MDM Server may be the
              Distinguished Name, Domain Name, and/or the IP address of the MDM Server. This
              requirement allows the specification of the information to be to be used to establish
              a network connection and the reference identifier for authenticating the trusted
              channel between the MDM Server and MDM Agent (FPT_ITT.1).</note>
            <aactivity>
              <h:h4>TSS</h:h4>The evaluator shall examine the TSS to verify that it describes which
              types of reference identifiers are acceptable and how the identifier is specified
              (e.g. preconfigured in the MDM Agent, by the user, by the MDM server, in a policy).
                <h:h4>Guidance</h:h4>The evaluator shall examine the operational guidance to verify that
              it describes how to configure reference identifier of the MDM Server’s certificate
              and, if different than the reference identifier, the Domain Name or IP address (for
              connectivity) of the MDM Server. <h:h4>Tests</h:h4>The evaluator shall follow the
              operational guidance to establish the reference identifier of the MDM server on the
              MDM Agent and in conjunction with other Assurance Activities verify that the MDM Agent
              can connect to the MDM Server and validate the MDM Server’s certificate. </aactivity>
          </f-element>
        </f-component>
      </subsection>
      <subsection id="fmt" title="Security Management (FMT)">
        <f-component id="FMT_SMF_EXT.3" name="Specification of Management Functions" status="threshold">
          <f-element id="FMT_SMF_EXT.3.1">
            <title>The MDM Agent shall be capable of interacting with the platform to perform the
              following functions: <h:ol type="a">
                <selectables linebreak="yes">
                  <selectable><h:li>administrator-provided management functions in MDF
                    PP</h:li></selectable>
                  <selectable><h:li>administrator-provided device management functions in MDM
                    PP</h:li></selectable>
                </selectables>
                <h:li>Import the certificates to be used for authentication of MDM Agent
                  communications</h:li>
                  <h:li/>
                <selectables>
                  <selectable><assignable>additional functions</assignable></selectable>
                  <selectable> no additional functions</selectable>
                </selectables>
              </h:ol>
            </title>
            <note role="application"> This requirement captures all the configuration functionality
              in the MDM Agent to configure the underlying Mobile Device with the configuration
              policies sent from the MDM Server to the Agent. The ST author selects the base PP (MDF
              PP or MDM PP) as the source of the management functions.<h:br/> The
              administrator-provided management functions in MDF PP are specified in Column 4 of
              Table 1 in MDF PPv2.x (reproduced in this EP as Table 8 in Appendix G) and in
              FPT_TUD_EXT.1 (for version queries). The administrator-provided device management
              functions in MDM PP are specified in FMT_SMF.1.1(1); the functions in the selection of
              FMT_SMF.1.1(1) in the MDM PP are required to correspond to the functions available on
              the platforms supported by the MDM Agent.<h:br/> The ST author can add more commands and
              configuration policies by completing the assignment statement; these additional
              commands or configuration policies must be supported by the Mobile Device.<h:br/> The
              agent must configure the platform based on the commands and configuration policies
              received from the MDM Server. The ST author shall not claim any functionality not
              provided by the supported Mobile Device(s). All selections and assignments performed
              by the ST author in this requirement should match the selections and assignments of
              the validated Mobile Device ST. </note>
            <aactivity>This assurance activity may be performed in conjunction with other assurance
              activities in the base PP. 
              <tss>The evaluator shall verify that the any
              assigned functions are described in the TSS and that these functions are documented as
              supported by the platform. The evaluator shall examine the TSS to verify that any
              differences between management functions and policies for each supported Mobile Device
              are listed.
              </tss>
              <guidance>The evaluator shall verify the AGD guidance includes
              detailed instructions for configuring each function in this requirement.<h:br/> If the
              MDM Agent is a component of the MDM system (i.e. MDM Server is the base PP), the
              evaluator shall verify, by consulting documentation for the claimed mobile device
              platforms, that the configurable functions listed for this Agent are supported by the
              platforms.<h:br/> If the MDM Agent supports multiple interfaces for configuration (for
              example, both remote configuration and local configuration), the AGD guidance makes
              clear whether some functions are restricted to certain interfaces.
              </guidance>
              <tests>
              <testlist>
                <test>In conjunction with the assurance activities in the base PP, the evaluator
                  shall attempt to configure each administrator-provided management function and
                  shall verify that the Mobile Device executes the commands and enforces the
                  policies.</test>
                <test>The evaluator shall configure the MDM Agent authentication certificate in
                  accordance with the configuration guidance. The evaluator shall verify that the
                  MDM Agent uses this certificate in performing the tests for FPT_ITT.1.</test>
                <test>(conditional) The evaluator shall design and perform tests to demonstrate that
                  the assigned function may be configured and that the intended behavior of the
                  function is enacted by the mobile device.</test>
              </testlist>
              </tests>
            </aactivity>
          </f-element>
          <f-element id="FMT_SMF_EXT.3.2">
            <title>The MDM Agent shall be capable of performing the following functions: <h:ol
                type="a">
                <h:li>Enroll in management</h:li>
                <h:li>Configure whether users can unenroll the agent from management</h:li>
                <h:li>
                  <selectables>
                    <selectable>configure periodicity of reachability events</selectable>
                    <selectable><assignable>other management functions</assignable></selectable>
                    <selectable>no other functions</selectable>
                  </selectables></h:li>
              </h:ol></title>
            <note role="application"> This requirement captures all of the configuration in the MDM
              Agent for configuration of itself.<h:br/> If the MDM Agent is a part of the mobile
              device, enrollment is a single function both of the Agent and of the mobile device
              (FMT_SMF_EXT.3.1).<h:br/> If the MDM Agent is an application developed separately from
              the mobile device, the MDM Agent performs the function “enroll the mobile device in
              management” (per FMT_SMF_EXT.3.1) by registering itself to the mobile device as a
              device administrator. The Agent itself is enrolled in management by configuring the
              MDM Server to which the Agent answers.<h:br/> If the Agent generates periodic
              reachability events in <linkref linkend="FAU_ALT_EXT.2.1"/> and the periodicity of these events is
              configurable, “configure periodicity of reachability events” must be selected. </note>
            <aactivity>
              <tss>The evaluator shall verify that the TSS describes the methods in which
              the MDM Agent can be enrolled. The TSS description shall make clear if the MDM Agent
              supports multiple interfaces for enrollment and configuration (for example, both
              remote configuration and local configuration).<h:br/> Additionally, the evaluator shall
              verify that the TSS describes any management functions of the MDM Agent.
              </tss>
              <guidance>
              The evaluator shall verify the AGD guidance includes detailed
              instructions for configuring each function in this requirement.
              </guidance>
              <tests>
              <testlist>
                <test>In conjunction with other assurance activities, the evaluator shall attempt to
                  enroll the MDM Agent in management with each interface identified in the TSS, and
                  verify that the MDM Agent can manage the device and communicate with the MDM
                  Server.</test>
                <test>(conditional) In conjunction with the assurance activity for 
                  <linkref linkend="FAU_ALT_EXT.2.1"/>,
                  the evaluator shall configure the periodicity for reachability events for several
                  configured time periods and shall verify that the MDM Server receives alerts on
                  that schedule.</test>
                <test>(conditional) The evaluator shall design and perform tests to demonstrate that
                  the assigned function may be configured and that the intended behavior of the
                  function is enacted by the mobile device.</test>
              </testlist>
              </tests>
            </aactivity>
          </f-element>
        </f-component>
        <f-component id="FMT_UNR_EXT.1" name="User Unenrollment Prevention" status="threshold">
          <f-element id="FMT_UNR_EXT.1.1">
            <title>The MDM Agent shall provide a mechanism to prevent users from unenrolling the
              mobile device from management.</title>
            <note role="application">Unenrolling is the action of transitioning from the enrolled
              state to the unenrolled state. If preventing the user from unenrolling is
              configurable, administrators configure whether users are allowed to unenroll through
              the MDM Server. For those configurations where unenrollment is allowed, the MDFPP
              describes configuration actions performed upon unenrollment in FMT_SMF_EXT.2.1;
              however, the MDM Agent is limited to those actions supported by the mobile device on
              which the Agent is operating.</note>
            <aactivity>
              <tss>The evaluator shall ensure that the TSS describes the mechanism used to
              prevent users for enrolling. This description shall indicate if any configuration
              allows users to unenroll.
              </tss>
              <guidance>
              The evaluator shall ensure that the
              administrative guidance instructs administrators in configuring the unenrollment
              prevention in each available configuration interface. If any configuration allows
              users to unenroll, the guidance also describes the actions that unenroll the Agent.
              </guidance>
              <tests>
              <testlist>
                <test>The evaluator shall configure the Agent according to the administrative
                  guidance for each available configuration interface, shall attempt to unenroll the
                  device, and shall verify that the attempt fails.</test>
                <test>(Conditional) If any configuration allows the user to unenroll, the evaluator
                  shall configure the Agent to allow user unenrollment, attempt to unenroll, and
                  verify the attempt succeeds.</test>
              </testlist>
              </tests>
            </aactivity>
          </f-element>
        </f-component>
        <f-component id="FMT_POL_EXT.2" name="Trusted Policy Update" status="objective">
          <f-element id="FMT_POL_EXT.2.1">
            <title>The MDM Agent shall only accept policies and policy updates digitally signed by
              the Enterprise.</title>
            <note role="application">The intent of this requirement is to cryptographically tie the
              policies to the enterprise that mandated the policy, not to protect the policies in
              transit (as they are already protected by FPT_ITT.1). This is especially critical for
              users who connect to multiple enterprises.<h:br/> Policies must be digitally signed by
              the enterprise using the algorithms in FCS_COP.1(3).</note>
            <aactivity>
              <tss>The evaluator also ensures that the TSS (or the operational guidance)
              describes how the candidate policies are obtained by the MDM Agent; the processing
              associated with verifying the digital signature of the policy updates; and the actions
              that take place for successful (signature was verified) and unsuccessful (signature
              could not be verified) cases. The software components that are performing the
              processing must also be identified in the TSS and verified by the evaluators.
              </tss>
              <tests>The evaluator shall perform a policy update from an available
              configuration interface (such as through a test MDM Server). The evaluator shall
              verify the update is signed and is provided to the MDM Agent. The evaluator shall
              verify the MDM Agent accepts the digitally signed policy. The evaluator shall perform
              a policy update from an available configuration interface (such as through a test MDM
              Server). The evaluator shall provide an unsigned and an incorrectly signed policy to
              the MDM Agent. The evaluator shall verify the MDM Agent does not accept the digitally
              signed policy.
              </tests>
            </aactivity>
          </f-element>
          <f-element id="FMT_POL_EXT.2.2">
            <title>The MDM Agent shall not install policies if the policy signing certificate is
              deemed invalid.</title>
            <aactivity> The assurance activity for this requirement is performed in conjunction with
              the assurance activity for FIA_X509_EXT.1 and FIA_X509_EXT.2. </aactivity>
          </f-element>
        </f-component>
      </subsection>
  </section>
    
  <section title="Security Assurance Requirements" id="SARs"> It is important to note that a TOE that
    is evaluated against this EP is inherently evaluated against the MDF PP or the MDM PP as well.
    Those PPs include a number of Assurance Activities associated with both Security Functional
    Requirements (SFRs) and SARs. Additionally, this EP includes a number of SFR-based Assurance
    Activities that similarly refine the SARs identified in the base PPs. The assurance activities
    associated with SARs that are prescribed by the MDF PP or MDM PP are performed against the
    entire TOE.
  </section>
    
  </chapter>
 
  <appendix title="Optional Requirements" id="optional"> The baseline requirements (those that must
    be performed by the mdm agent are contained in the main body of this EP. Additionally, there are
    three other types of requirements specified in <appref linkend="optional"/>, <appref
      linkend="sel-based"/>, and <appref linkend="objective"/>. The first type (in this Appendix)
    are requirements that can be included in the <abbr linkend="ST"/>, but are not required in order
    for an mdm agent to claim conformance to this PP. The second type (in <appref
      linkend="sel-based"/>) are requirements based on selections in the body of the EP: if certain
    selections are made, then additional requirements in that appendix must be included. The third
    type (in <appref linkend="objective"/> are components that are not required in order to conform
    to this EP, but will be included in the baseline requirements in future versions of this EP, so
    adoption by vendors is encouraged. Note that the ST author is responsible for ensuring that
    requirements that may be associated with those in <appref linkend="optional"/>, <appref
      linkend="sel-based"/>, and <appref linkend="objective"/> but are not listed (e.g., FMT-type
    requirements) are also included in the ST.</appendix>
  <appendix title="Selection-Based Requirements" id="sel-based">As indicated in the introduction to
    this EP, the baseline requirements (those that must be performed by the mdm agent or its
    underlying platform) are contained in the body of this EP. There are additional requirements
    based on selections from the MDM or MDF PP and/or in the body of the EP: if certain selections
    are made, then additional requirements below will need to be included.</appendix>
  <appendix title="Objective Requirements" id="objective"> This Annex includes requirements that
    specify security functionality which also addresses threats. The requirements are not currently
    mandated in the body of this EP as they describe security functionality not yet widely-available
    in commercial technology. However, these requirements may be included in the ST such that the
    mdm agent is still conformant to this EP, and it is expected that they be included as soon as
    possible.</appendix>

<appendix title="Entropy Documentation and Assessment" id="entropyappendix"> 
  This appendix describes the required supplementary information for the entropy
  source used by the TOE.
  <h:br/>
  The documentation of the entropy source should be detailed enough that, after
  reading, the evaluator will thoroughly understand the entropy source and why
  it can be relied upon to provide sufficient entropy. This documentation should
  include multiple detailed sections: design description, entropy justification,
  operating conditions, and health testing. This documentation is not required to
  be part of the TSS. 
   
<section id="entropydesign" title="Design Description">
  Documentation shall include the design of the entropy source as a whole,
  including the interaction of all entropy source components. Any information
  that can be shared regarding the design should also be included for any
  third-party entropy sources that are included in the product. 
  <h:br/>
  The documentation will describe the operation of the entropy source to
  include, how entropy is produced, and how unprocessed (raw) data can be
  obtained from within the entropy source for testing purposes. The documentation
  should walk through the entropy source design indicating where the entropy
  comes from, where the entropy output is passed next, any post-processing
  of the raw outputs (hash, XOR, etc.), if/where it is stored, and finally,
  how it is output from the entropy source. Any conditions placed on the
  process (e.g., blocking) should also be described in the entropy source
  design. Diagrams and examples are encouraged. 
  <h:br/>
  This design must also include a description of the content of the
  security boundary of the entropy source and a description of how
  the security boundary ensures that an adversary outside the boundary
  cannot affect the entropy rate.
  <h:br/>
  If implemented, the design description shall include a description
  of how third-party applications can add entropy to the RBG. A
  description of any RBG state saving between power-off and
  power-on shall be included.
</section>

<section id="entropyjustification" title="Entropy Justification">
  There should be a technical argument for where the unpredictability in
  the source comes from and why there is confidence in the entropy source
  delivering sufficient entropy for the uses made of the RBG output
  (by this particular TOE). This argument will include a description of
  the expected min-entropy rate (i.e. the minimum entropy (in bits) per
  bit or byte of source data) and explain that sufficient entropy is
  going into the TOE randomizer seeding process. This discussion will
  be part of a justification for why the entropy source can be relied
  upon to produce bits with entropy.
  <h:br/>
  The amount of information necessary to justify the expected
  min-entropy rate depends on the type of entropy source included in the
  product.
  <h:br/>
  For developer provided entropy sources, in order to justify the
  min-entropy rate, it is expected that a large number of raw source
  bits will be collected, statistical tests will be performed, and the
  min-entropy rate determined from the statistical tests. While no
  particular statistical tests are required at this time, it is expected
  that some testing is necessary in order to determine the amount of
  min-entropy in each output.
  <h:br/>
  For third party provided entropy sources, in which the TOE vendor
  has limited access to the design and raw entropy data of the source, the
  documentation will indicate an estimate of the amount of min-entropy
  obtained from this third-party source.  It is acceptable for the vendor
  to “assume” an amount of min-entropy, however, this assumption must be
  clearly stated in the documentation provided.  In particular, the
  min-entropy estimate must be specified and the assumption included
  in the ST.
  <h:br/>
  Regardless of type of entropy source, the justification will also
  include how the DRBG is initialized with the entropy stated in the ST,
  for example by verifying that the min-entropy rate is multiplied by the
  amount of source data used to seed the DRBG or that the rate of entropy
  expected based on the amount of source data is explicitly stated and
  compared to the statistical rate. If the amount of source data used to
  seed the DRBG is not clear or the calculated rate is not explicitly
  related to the seed, the documentation will not be considered complete.
  <h:br/>
  The entropy justification shall not include any data added from
  any third-party application or from any state saving between restarts.
</section>

<section id="entropyoperatingconditions" title="Operating Conditions">
  The entropy rate may be affected by conditions outside the control
  of the entropy source itself.  For example, voltage, frequency,
  temperature, and elapsed time after power-on are just a few of the
  factors that may affect the operation of the entropy source.
  As such, documentation will also include the range of operating conditions
  under which the entropy source is expected to generate random data.
  It will clearly describe the measures that have been taken in the
  system design to ensure the entropy source continues to operate
  under those conditions. Similarly, documentation shall describe
  the conditions under which the entropy source is known to malfunction
  or become inconsistent. Methods used to detect failure or degradation
  of the source shall be included.
</section>

  <section id="entropyhealthtesting" title="Health Testing">
    More specifically, all entropy source health tests and their rationale
    will be documented. This will include a description of the health tests,
    the rate and conditions under which each health test is performed
    (e.g., at startup, continuously, or on-demand), the expected results
    for each health test, and rationale indicating why each test is
    believed to be appropriate for detecting one or more failures in the
    entropy source.
  </section>
    
  </appendix>

  <appendix id="biblio" title="References">
    <bibliography>
      <entry id="bibCC">
        <tag>CC</tag>
        <description>Common Criteria for Information Technology Security Evaluation - <h:ul>
            <h:li><h:a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART1V3.1R4.pdf">Part
                1: Introduction and General Model</h:a>, CCMB-2012-09-001, Version 3.1 Revision 4,
              September 2012.</h:li>
            <h:li><h:a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART2V3.1R4.pdf">Part
                2: Security Functional Components</h:a>, CCMB-2012-09-002, Version 3.1 Revision 4,
              September 2012.</h:li>
            <h:li><h:a href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART3V3.1R4.pdf">Part
                3: Security Assurance Components</h:a>, CCMB-2012-09-003, Version 3.1 Revision 4,
              September 2012.</h:li>
          </h:ul></description>
      </entry>
      <entry id="bibMDMPP">
        <tag>MDM PP</tag>
        <description>
          <h:a href="https://www.niap-ccevs.org/pp/PP_MDM_V2.0/">Protection Profile for Mobile Device
            Management</h:a>
        </description>
      </entry>
      <entry id="bibMDfPP">
        <tag>MDF PP</tag>
        <description>
          <h:a href="https://www.niap-ccevs.org/pp/PP_MD_v2.0/">Protection Profile for Mobile Device
            Fundamentals</h:a>
        </description>
      </entry>
    </bibliography>
  </appendix>
  <appendix title="Acronyms" id="acronyms">
    <acronyms>
      <entry>
        <term>DTLS</term>
        <description>Datagram Transport Layer Security</description>
      </entry>
      <entry>
        <term>HTTPS</term>
        <description>Hypertext Transfer Protocol Secure</description>
      </entry>
      <entry>
        <term>MD</term>
        <description>Mobile Device</description>
      </entry>
      <entry>
        <term>MDM</term>
        <description>Mobile Device Management</description>
      </entry>
      <entry>
        <term>MAS</term>
        <description>Mobile Application Store</description>
      </entry>
    </acronyms>
  </appendix>
</PP>
