<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../transforms/module/module2html.xsl"?>
<?xml-model href="https://github.com/commoncriteria/transforms/raw/master/schemas/CCModule.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>
<!--  
<?xml-model href="../transforms/schemas/CCModule.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>
-->

<!-- To Do
  threats: objective refers - DONE
  assumptions: objective refers - DONE
  OSPs: objective refers (Organizational Security Policies) - DONE
  TODO :security objectives - DONE; note, changed so they look like the ones in MDF, there are no mappings or rationales
  Free The Toe - Done
  TODO: Need to check the Supporting Document - not all of the EAs are being pulled over: None of the TOE Security Functional Requirements show up in the SD
  
  FIA_X509_EXT.2.3 - requires an unique client certificate. Agent pulls it in from the base, but it is only in Server, and not in MDF. So should we add it as an additional requirement if the base is MDF 
  fix table refs in text so that they refer to the correct #s
 
 -->



<Module boilerplate="yes" target-products="MDM Agents" xmlns="https://niap-ccevs.org/cc/v1" name="Mobile Device Management Agents" 
  xmlns:htm="http://www.w3.org/1999/xhtml">
  <PPReference>
    <ReferenceTable>
      <PPVersion>4.0</PPVersion>
      <!--  <PPTitle>Extended Package for Mobile Device Management Agents</PPTitle>-->      
      <PPAuthor>National Information Assurance Partnership</PPAuthor>
      <PPPubDate>2018-11-28</PPPubDate>
      <!--  <PPCertificationID>NIAP</PPCertificationID>-->
      <!--  <CCVersion>Version 3.0</CCVersion>-->
      <Keywords>Mobile Device Management; MDM; MDM Agents</Keywords>
     <!-- <entry>
        <name>Registration</name>
        <description>National Information Assurance Partnership</description>
      </entry> --> 
    </ReferenceTable>
  </PPReference>
  <RevisionHistory>   
    <entry>
      <version>1.0</version>
      <date>2013-10-21</date>
      <subject>Initial Release</subject>
    </entry>
    <entry>
      <version>1.1</version>
      <date>2014-02-07</date>
      <subject>Typographical changes and clarifications to front-matter</subject>
    </entry>
    <entry>
      <version>2.0</version>
      <date>2014-12-31</date>
      <subject>Separation of MDM Agent SFRs.
        Updated cryptography, protocol, X.509 requirements.
        Added objective requirement for Agent audit storage.
        New requirement for unenrollment prevention.
        Initial Release of MDM Agent EP.</subject>
    </entry>
    <entry>
      <version>3.0</version>
      <date>2016-11-21</date>
      <subject>
        Updates to align with Technical Decisions.
        Added requirements to support BYOD use case.
      </subject>
    </entry>
    <entry>
      <version>4.0</version>
      <date>2018-12-20</date>
      <subject><!-- TODO: Add description of what we changed in this version -->
      Convert to PP-Module.     
      </subject>
    </entry>
  </RevisionHistory>  
  <chapter id="Introduction" title="Introduction">
    <section id="overview" title="Overview">
      The scope of this <abbr linkend="PP-Module"/> is to describe the security functionality of a Mobile Device Management (MDM) Agent in terms of [<abbr linkend="CC"/>] and to define functional and assurance requirements for such products. This PP-Module is intended for use with the following Base-PPs: <htm:ul>
        <htm:li>Mobile Device Management (MDM) Protection Profile Version 4.0</htm:li>
        <htm:li>Mobile Device Fundamentatls (MDF) Protection Profile Version 3.1</htm:li> <!-- NIAP: If we have to specify version numbers then what do we do when we update MDF?? -->
      </htm:ul>
      <htm:br/>
      These Base-PPs are valid because a MDM Agent is either a 3rd party application manufactured by the MDM Server vendor or is a native application deployed on a mobile device.   
    </section>
    <section id="glossary" title="Terms">     
      <subsection title="Common Criteria Terms">
        <glossary>
          <entry>
            <term><abbr title="Base Protection Profile">Base-PP</abbr></term>
            <description>Protection Profile used to build a PP-Configuration.</description>
          </entry>          
          <entry>           
            <term><abbr title="Common Criteria">CC</abbr></term>
            <description>Common Criteria for Information Technology Security Evaluation (International Standard ISO/IEC 15408).</description>
          </entry>
          <entry>
            <term>Common Criteria Testing Laboratory</term>
            <description>Within the context of the Common Criteria Evaluation and Validation Scheme (CCEVS), an IT security evaluation facility, accredited by the National Voluntary Laboratory Accreditation Program (NVLAP) and approved by the NIAP Validation Body to conduct Common Criteria-based evaluations.</description>
          </entry>
          <entry>
            <term><abbr title="Common Evaluation Methodology">CEM</abbr></term>
            <description>Common Evaluation Methodology for Information Technology Security Evaluation.</description>
          </entry>
          <!-- <entry>
            <term><abbr title="Extended Package">EP</abbr></term>
            <description>An implementation-independent set of security requirements for a specific subset of products described by a <abbr linkend="PP"/>.</description>
          </entry>-->         
          <entry>
            <term><abbr title="Protection Profile">PP</abbr></term>
            <description>An implementation-independent set of security requirements for a category of products.</description>
          </entry>
          <entry>
            <term><abbr title="Protection Profile Configuration">PP-Configuration</abbr></term>
            <description>Protection Profile composed of Base Protection Profiles and Protection Profile Module.</description>
          </entry>
          <entry>
            <term><abbr title="Protection Profile Module">PP-Module</abbr></term>
            <description>An implementation-independent statement of security needs for a TOE type complementary to one or more Base Protection Profiles.
            </description>
          </entry>
          <entry>
            <term><abbr title="Security Assurance Requirement">SAR</abbr></term>
            <description>A requirement for how the <abbr linkend="TOE"/>’s proper implementation of the <abbr linkend="SFR"/>s is verified by an evaluator.</description>
          </entry>
          <entry>
            <term><abbr title="Security Functional Requirement">SFR</abbr></term>
            <description>A requirement for security enforcement by the <abbr linkend="TOE"/>.</description>
          </entry>
          <entry>
            <term><abbr title="Security Target">ST</abbr></term>
            <description>A set of implementation-dependent security requirements for a specific product.</description>
          </entry>
          <entry>
            <term><abbr title="Target of Evaluation">TOE</abbr></term>
            <description>The security functionality of the product under evaluation.</description>
          </entry>
          <entry>
            <term><abbr title="TOE Security Functionality">TSF</abbr></term>
            <description>The security functionality of the product under evaluation.</description>
          </entry>
          <entry>
            <term><abbr title="TOE Summary Specification">TSS</abbr></term>
            <description>A description of how a <abbr linkend="TOE"/> satisfies the <abbr linkend="SFR"/>s in an <abbr linkend="ST"/>.</description>
          </entry>
        </glossary>
      </subsection>
      <subsection title="Technical Terms">
        <glossary>
        <entry>
            <term>Administrator</term>
            <description>The person who is responsible for management activities, including setting the policy that is applied by the enterprise on the mobile device.</description>
          </entry>
          <entry>
            <term>Enrolled State</term>
            <description>The state in which a mobile device is managed by a policy from an MDM.</description>
          </entry>
          <entry>
            <term>Mobile Device User</term>
            <description>The person who uses and is held responsible for a mobile device.</description>
          </entry>
          <entry>
            <term>Operating System</term>
            <description>Software which runs at the highest privilege level and can directly control hardware resources. Modern mobile devices typically have at least two primary operating systems: one which runs on the cellular baseband processor and one which runs on the application processor. The platform of the application processor handles most user interaction and provides the execution environment for apps. The platform of the cellular baseband processor handles communications with the cellular network and may control other peripherals. The term OS, without context, may be assumed to refer to the platform of the application</description>
          </entry>
          <entry>
            <term>Unenrolled State</term>
            <description>The state in which a mobile device is not managed by an MDM system.</description>
          </entry>
          <entry>
            <term>User</term>
            <description>See Mobile Device User.</description>
          </entry>
        </glossary>
      </subsection>
    </section>
    <section id="targets" title="Compliant Targets of Evaluation">
      The MDM system consists of two primary components: the MDM Server software and the MDM Agent. This <abbr linkend="PP-Module"/> specifically addresses the MDM Agent. A compliant MDM Agent is installed on a mobile device as an application (supplied by the developer of the MDM Server software) or is part of the mobile device’s OS. The MDM Agent establishes a secure connection back to the MDM Server, from which it receives policies to enforce on the mobile device. Optionally, the MDM Agent interacts with the Mobile Application Store (MAS) Server to download and install enterprise-hosted applications.<htm:br/><htm:br/> 
      If the MDM Agent is part of the mobile device’s OS, the MDM Agent may present multiple interfaces for configuring the mobile device, such as a local interface and a remote interface. Agents conforming to this <abbr linkend="PP-Module"/> must at least offer an interface with a trusted channel that serves as one piece of an MDM system. Conformant MDM Agents may also offer other interfaces, and the configuration aspects of these additional interfaces are in scope of this <abbr linkend="PP-Module"/>.<htm:br/><htm:br/> 
      This <abbr linkend="PP-Module"/> builds on either the Mobile Device Fundamentals <abbr linkend="PP"/> v3.1 or the Mobile Device Management Server <abbr linkend="PP"/> v4.0. A TOE that claims conformance to this <abbr linkend="PP-Module"/> must also claim conformance to one of those PPs as its Base-PP. A compliant <abbr linkend="TOE"/> is obligated to implement the functionality required in the Base-PP along with the additional functionality defined in this <abbr linkend="PP-Module"/> in order to mitigate the threats that are defined by this <abbr linkend="PP-Module"/>.<htm:br/><htm:br/> 
      This <abbr linkend="PP-Module"/> shall build on Mobile Device Fundamentals PP if the <abbr linkend="TOE"/> is a native part of a mobile operating system. The <abbr linkend="TOE"/> for this <abbr linkend="PP-Module"/> combined with the MDF <abbr linkend="PP"/> is the mobile device itself plus the MDM Agent.<htm:br/><htm:br/>
      This <abbr linkend="PP-Module"/> shall build on the MDM Server PP if the <abbr linkend="TOE"/> is a third-party application that is provided with an MDM Server and installed on a mobile device by the user after acquiring the mobile device. The distributed <abbr linkend="TOE"/> for this <abbr linkend="PP-Module"/> combined with the MDM Server <abbr linkend="PP"/> is the entire MDM environment, which includes both the MDM Server and the MDM Agent. Even though the mobile device itself is not part of the <abbr linkend="TOE"/>, it is expected to be evaluated against the MDF <abbr linkend="PP"/> so that its baseline security capabilities can be assumed to be present.

<!-- SCHEMA: Would not let me do a section for TOE Boundary -->
      Figure 1 shows a high-level example of the <abbr linkend="PP-Module"/> <abbr linkend="TOE"/> boundary and its operational environment. As stated above, the MDM Agent may either be provided as part of the mobile device itself (shown in red) or distributed as a third-party application from the developer of the MDM Server software (shown in blue).<htm:br/><htm:br/>    
        <figure entity="images/mdm-system-operating-environment.png" title="MDM System Operating Environment" id="toe"/><htm:br/>
        The MDM Agent must closely interact with or be part of the mobile device’s platform in order to establish policies and to perform queries about device status. The mobile device, in turn, has its own security requirements specified in the MDF <abbr linkend="PP"/>. 
      <!-- NIAP: Is this still true?? -->The mobile device must be evaluated against the MDF <abbr linkend="PP"/>, either concurrently with the MDM Agent or prior to the evaluation of the MDM Agent. This is true regardless of whether the MDM Agent is a native part of the mobile device OS or a third-party application.<htm:br/><htm:br/>      
    </section>
    <section title="Use Cases" id="usecase">
      This <abbr linkend="PP-Module"/> defines 4 use cases:<htm:br/><htm:br/>
          <usecases>
            <usecase title="Enterprise-owned device for general-purpose enterprise use" id="usecase1">
              <description>
                An Enterprise-owned device for general-purpose business use is commonly called Corporately Owned, Personally Enabled (COPE). This use case entails a significant degree of Enterprise control over configuration and software inventory. Enterprise administrators use an MDM product to establish policies on the mobile devices prior to user issuance. Users may use Internet connectivity to browse the web or access corporate mail or run Enterprise applications, but this connectivity may be under significant control of the Enterprise. The user may also be expected to store data and use applications for personal, non-enterprise use. The Enterprise administrator uses the MDM product to deploy security policies and query mobile device status. The MDM may issue commands for remediation actions.
              </description>
            </usecase>
            <usecase title="Enterprise-owned device for specialized, high-security use" id="usecase2">
              <description>An Enterprise-owned device with intentionally limited network connectivity, tightly controlled configuration, and limited software inventory is appropriate for specialized, high-security use cases. As in the previous use case, the MDM product is used to establish such policies on mobile devices prior to issuance to users. The device may not be permitted connectivity to any external peripherals. It may only be able to communicate via its Wi-Fi or cellular radios with the Enterprise-run network, which may not even permit connectivity to the Internet. Use of the device may require compliance with usage policies that are more restrictive than those in any general-purpose use case, yet may mitigate risks to highly sensitive information. Based upon the operation environment and the acceptable risk level of the enterprise, those security functional requirements outlined in Section 5 <!-- TODO: Update reference -->of this Protection Profile along with the selections in the <!-- TODO: Will need to update this reference to use case templats -->Use Case 2 template defined in Section G.2 are sufficient for the high-security use case.
              </description>
            </usecase>
            <usecase title="Personally owned device for personal and enterprise use" id="usecase3">
              <description>A personally owned device, which is used, for both personal activities and enterprise data is commonly called Bring Your Own Device (BYOD). The device may be provisioned for access to enterprise resources after significant personal usage has occurred. Unlike in the enterprise-owned cases, the enterprise is limited in what security policies it can enforce because the user purchased the device primarily for personal use and is unlikely to accept policies that limit the functionality of the device.<htm:br/><htm:br/>
                However, because the Enterprise allows the user full (or nearly full) access to the Enterprise network, the Enterprise will require certain security policies, for example a password or screen lock policy, and health reporting, such as the integrity of the mobile device system software, before allowing access. The administrator of the MDM can establish remediation actions, such as wipe of the Enterprise data, for non-compliant devices. These controls could potentially be enforced by a separation mechanism built-in to the device itself to distinguish between enterprise and personal activities, or by a third-party application that provides access to enterprise resources and leverages security capabilities provided by the mobile device. Based upon the operational environment and the acceptable risk level of the enterprise, those security functional requirements outlined in Section 5 of this Protection Profile along with the selections in the Use Case 3 template defined in Section G.3 are sufficient for the secure implementation of this BYOD use case.</description>
            </usecase>
            <usecase title="Personally owned device for personal and limited enterprise use" id="usecase4">
              <description>A personally owned device may also be given access to limited enterprise services such as enterprise email. Because the user does not have full access to the enterprise or enterprise data, the enterprise may not need to enforce any security policies on the device. However, the enterprise may want secure email and web browsing with assurance that the services being provided to those clients by the Mobile Device are not compromised. Based upon the operational environment and the acceptable risk level of the enterprise, those security functional requirements outlined in Section 5 of this <abbr linkend="PP"/> are sufficient for the secure implementation of this BYOD use case.</description>
            </usecase>
          </usecases>           
<!-- The Following was appendix E in Agent EP that defined the selections needed, not sure where to put it in the module -->
        <!--  The following use case templates list those selections, assignments, and objective requirements that best support the use cases identified by this Protection Profile. Note that the templates assume that all <abbr linkend="SFR"/>s listed in Section 5 are included in the <abbr linkend="ST"/>, not just those listed in the templates. These templates and deviations from the template should be identified in the Security Target to assist customers with making risk-based purchasing decisions. Products that do not meet these templates are not precluded from use in the scenarios identified by this Protection Profile.<htm:br/><htm:br/>
        Where selections for a particular requirement are not identified in a use case template, all available selections are equally applicable to the use case.<htm:br/><htm:br/>
        
        <usecase id="usecase1" title="Enterprise-owned device for general-purpose enterprise use">
          <description></description>
        </usecase>
        <usecase title="Enterprise-owned device for specialized, high-security use" id="usecase2">
          <description>
            <htm:table>
              <htm:tr>
                <htm:th>Requirement</htm:th>
                <htm:th>Action</htm:th>
              </htm:tr>
              <htm:tr>
                <htm:td>FAU_ALT_EXT.2.1 Function c</htm:td>
                <htm:td>Include in <abbr linkend="ST"/>.</htm:td>
              </htm:tr>
              <htm:tr>
                <htm:td>FMT_UNR_EXT.1.1</htm:td>
                <htm:td>Select “prevent the unenrollment from occurring”.</htm:td>
              </htm:tr>
            </htm:table>
            <htm:br/><htm:br/>
          </description>
        </usecase>
        <usecase title="Personally owned device for personal and enterprise use" id="usecase3">
          <description>
            <htm:table>
              <htm:tr>
                <htm:th>Requirement</htm:th>
                <htm:th>Action</htm:th>
              </htm:tr>
              <htm:tr>
                <htm:td>FMT_UNR_ENT.1.1</htm:td>
                <htm:td>Select “apply remediation actions”</htm:td>
              </htm:tr>
            </htm:table>
            <htm:br/><htm:br/>
          </description>
        </usecase>
        <usecase title="Personally owned device for personal and limited enterprise" id="usecase4">
          <description>At this time no requirements are recommended for this use case.</description>
        </usecase>
      -->
    </section>  
  </chapter>
  <chapter title="Conformance Claims" id="conf">
    <cclaims>
      <cclaim title="Conformance Statement">
        <description>To be conformant to this <abbr linkend="PP-Module"/>, an <abbr linkend="ST"/> must demonstrate Exact Conformance, as defined by the [<abbr linkend="CC"/>] and CEM addenda for Exact Conformance, Selection-Based SFRs, and Optional SFRs (dated May 2017). Exact Conformance is described in CC and CEM addenda for Exact Conformance. An ST that conforms to this PP-Module must also demonstrate Exact Conformance to the Base-PP and also make any necessary inclusions, modifications, or exclusions as mandated by a PP-Configuration that includes both this PP-Module and the Base-PP. <htm:br/><htm:br/>
          The <abbr linkend="ST"/> must include all components in this <abbr linkend="PP"/> that are:<htm:ul>
          <htm:li>Unconditional (which are always required)</htm:li>
          <htm:li>Selection-based (which are required when certain selections are chosen in the unconditional requirements)</htm:li>
        </htm:ul>
        It may also include components that are:    
        <htm:ul>
          <htm:li>Optional</htm:li>
          <htm:li>Objective</htm:li>
        </htm:ul>
        Unconditional requirements are found in the main body of the document (Section 5), while appendices contain the selection-based, optional, and objective requirements. The <abbr linkend="ST"/> may iterate any of these components but it must not introduce any additional component (e.g., from <abbr linkend="CC"/> Part 2 or 3) that is not defined in this <abbr linkend="PP-Module"/>.
        <htm:br/>
      </description>
    </cclaim>     
      <cclaim title="CC Conformance Claims">
        <description>This <abbr linkend="PP-Module"/> is conformant to Parts 2 (extended) and 3 (conformant) of Common Criteria Version 3.1, Revision 5 [<abbr linkend="CC"/>].
        </description>
      </cclaim>
      <cclaim title="PP Claims">
        <description>This <abbr linkend="PP-Module"/> does not claim conformance to any Protection Profile.</description>
      </cclaim>
      <cclaim title="Package Claims">
        <description>This <abbr linkend="PP-Module"/> does not claim conformance to any packages.</description>
      </cclaim>
  </cclaims>
</chapter>
  <chapter id="spd" title="Security Problem Description">
    <section id="threats" title="Threats">
      The following threats are specific to MDM Agents, and represents an addition to those identified in the Base PP. 
     
      <!-- Question: What if a threat is in MDF but not MDM or the other way around? -->
      <!-- Question: Do I need consistency rationale for Threats -->
      <!-- Note: Threats contained in both base PPs have been commented out -->
      <threats>      
        <!--  <threat id="T.MALICIOUS_APPS"> 
          <description>
              Malicious or flawed application threats exist because apps loaded onto a mobile device may include malicious or 
              exploitable code. An administrator of the MDM or mobile device user may inadvertently import malicious code, or an 
              attacker may insert malicious code into the <abbr linkend="TOE"/>, resulting in the compromise of <abbr linkend="TOE"/> 
              or <abbr linkend="TOE"/> data.
          </description>
          <consistency-rationale>           
          </consistency-rationale>
          <objective-refer ref="O.DATA_PROTECTION_TRANSIT"> 
            <rationale>The threat T.MALICIOUS_APPS is countered by O.DATA_PROTECTION_TRANSIT as this provides the capability to 
              protect app loading/updates against malicious insertion from the network.</rationale>
          </objective-refer>
          <objective-refer ref="O.APPLY_POLICY">
            <rationale>The threat T.MALICIOUS_APPS is countered by O.APPLY_POLICY as this provides policy preventing loading
              of unapproved apps into the <abbr linkend="TOE"/>.</rationale>
          </objective-refer>
          </threat>  -->    
        <threat id="T.BACKUP">
            <description> An attacker may try to target backups of data or credentials and exfiltrate data. Since the backup is stored on either a personal computer or end user’s backup repository, it’s not likely enterprise would detect compromise.</description>
          <consistency-rationale></consistency-rationale>
          <objective-refer ref="O.DATA_PROTECTION_TRANSIT"> 
            <rationale>The threat T.BACKUP is countered by O.DATA_PROTECTION_TRANSIT as this provides the capability to 
              communicate using one (or more) standard protocols as a means to maintain the confidentiality of data that are 
              transmitted between the Agent and other entities.</rationale>
          </objective-refer>
          <!-- SCHEMA: Why can't we link two objectives to this threat?? -->
          <objective-refer ref="O.APPLY_POLICY">
            <rationale>The threat T.BACKUP is countered by O.APPLY_POLICY as this provides policy to enforce that backups
            be stored ony in secure, protected locations.</rationale>
          </objective-refer>
          </threat>       
        <!--  <threat id="T.NETWORK_ATTACK"> 
          <description>
            An attacker is positioned on a wireless communications channel or elsewhere on the network infrastructure. Attackers 
            may initiate communications with the Agent or alter communications between the Agent and other endpoints 
            in order to compromise the Agent or software managed by the Agent. These attacks include malicious software update of 
            any applications managed by the Agent, device updates managed by the Agent, updates to the Agent itself. These attacks 
            also include malicious changes to MDM policy on or managed by the Agent, tampering with security logs on or managed
            by the Agent, or other malicious disruptions of normal Agent performance via the network.</description>
          <objective-refer ref="O.DATA_PROTECTION_TRANSIT"> 
            <rationale>The threat T.NETWORK_ATTACK is countered by O.DATA_PROTECTION_TRANSIT as this provides the capability to 
              communicate using one (or more) standard protocols as a means to maintain the confidentiality of data that are 
              transmitted between the Agent and other entities.</rationale>
          </objective-refer>
          <objective-refer ref="O.APPLY_POLICY">
            <rationale>The threat T.NETWORK_ATTACK is countered by O.APPLY_POLICY as this provides a secure configuration of the Agent to protect data that it processes.</rationale>
          </objective-refer>
        </threat>-->
        <!--  <threat id="T.NETWORK_EAVESDROP"> 
          <description><htm:b>Network Attack</htm:b><htm:br></htm:br><htm:br></htm:br>
            An attacker is positioned on a wireless communications channel or elsewhere on the network infrastructure. Attackers 
            may initiate communications with the Agent or alter communications between the Agent and other endpoints 
            in order to compromise the Agent or software managed by the Agent. These attacks include malicious software update of 
            any applications managed by the Agent, device updates managed by the Agent, updates to the Agent itself. These attacks 
            also include malicious changes to MDM policy on or managed by the Agent, tampering with security logs on or managed
            by the Agent, or other malicious disruptions of normal Agent performance via the network.</description>
          <objective-refer ref="O.DATA_PROTECTION_TRANSIT"> 
            <rationale>The threat T.NETWORK_EAVESDROP is countered by O.DATA_PROTECTION_TRANSIT as this provides the capability to 
              communicate using one (or more) standard protocols as a means to maintain the confidentiality of data that are 
              transmitted between the Agent and other entities.</rationale>
          </objective-refer>
          <objective-refer ref="O.APPLY_POLICY">
            <rationale>The threat T.NETWORK_EAVESDROP is countered by O.APPLY_POLICY as this provides a secure configuration of the Agent to protect data that it processes.</rationale>
          </objective-refer>
        </threat>-->
        <!-- <threat id="T.PHYSICAL_ACCESS"> 
          <description>The mobile device may be lost or stolen, and an unauthorized individual may attempt to access user data. Although these attacks are primarily directed against the mobile device platform, the MDM Agent configures features, which address this threat.</description>
          <objective-refer ref="O.ACCOUNTABILITY"> 
            <rationale>The threat T.PHYSICAL_ACCESS is countered by O.ACCOUNTABILITY as this provides the capability to 
              log attempts by unauthorized personnel to access data, and to log any access to the data or the device, as well as
              changes to the device during the time when it is not under the control of an authorized user.</rationale>
          </objective-refer>
          <objective-refer ref="O.APPLY_POLICY">
            <rationale>The threat T.PHYSICAL_ACCESS is countered by O.APPLY_POLICY as this provides a secure configuration of the Agent to protect data that it processes.</rationale>
          </objective-refer>
        </threat> -->
      </threats>
    </section>
    <section id="Assumptions" title="Assumptions">
      <!-- NIAP: There are some assumptions and OSPs that are only in MDM, not MDF. How to handle these? -->
      <assumptions>
        <assumption id="A.CONNECTIVITY"> <!-- MDM -->
          <description>The <abbr linkend="TOE"/> relies on network connectivity to carry out its management activities. The <abbr linkend="TOE"/> will robustly handle instances when connectivity is unavailable or unreliable.
          </description>
          <objective-refer ref="OE.WIRELESS_NETWORK">
            <rationale>The operational environment objective OE.WIRELESS_NETWORK is realized through A.CONNECTIVITY. </rationale>
          </objective-refer>
        </assumption>
        <assumption id="A.MOBILE_DEVICE_PLATFORM">
          <description>The MDM Agent relies upon mobile platform and hardware evaluated against the MDFPP and assured to provide policy enforcement as well as cryptographic services and data protection. The mobile platform provides trusted updates and software integrity verification of the MDM Agent.</description>
          <objective-refer ref="OE.MOBILE_DEVICE_PLATFORM">
            <rationale>The operational environment objective OE.MOBILE_DEVICE_PLATFORM is realized through A.MOBILE_DEVICE_PLATFORM. </rationale>
          </objective-refer>
        </assumption>
        <assumption id="A.PROPER_ADMIN"> <!-- MDM -->
          <description>One or more competent, trusted personnel who are not careless, willfully negligent, or hostile, are assigned and authorized as the <abbr linkend="TOE"/> Administrators, and do so using and abiding by guidance documentation.</description>
          <objective-refer ref="OE.DATA_PROPER_ADMIN">
            <rationale>The operational environment objective OE.DATA_PROPER_ADMIN is realized through A.PROPER_ADMIN. </rationale>
          </objective-refer>
        </assumption>
        <assumption id="A.PROPER_USER"> <!-- MDM -->
          <description>
            Mobile device users are not willfully negligent or hostile, and use the device within compliance of a reasonable Enterprise security policy.
          </description>
          <objective-refer ref="OE.DATA_PROPER_USER">
            <rationale>The operational environment objective OE.DATA_PROPER_USER is realized through A.PROPER_USER. </rationale>
          </objective-refer>        
        </assumption>
      </assumptions>
    </section> 
    <section id="securityPolicy" title="Organizational Security Policies">
      <OSPs>
        <OSP id="P.ACCOUNTABILITY"><!-- MDM -->
          <description>Personnel operating the <abbr linkend="TOE"/> shall be accountable for their actions within the <abbr linkend="TOE"/>.</description>
          <objective-refer ref="O.ACCOUNTABILITY">
            <rationale>O.ACCOUNTABILITY provides logging of personnel actions in order to provide accountability of all personnel 
              actions within the <abbr linkend="TOE"/>.</rationale>
          </objective-refer>
        </OSP>
        <OSP id="P.ADMIN"><!-- MDM -->
          <description>The configuration of the mobile device security functions must adhere to the Enterprise security policy.</description>
          <objective-refer ref="O.APPLY_POLICY">
            <rationale>The <abbr linkend="TOE"/> adheres to the Enterprise security policy through the application of O.APPLY_POLICY.</rationale>
          </objective-refer>
        </OSP>
        <OSP id="P.DEVICE_ENROLL"><!-- MDM -->
          <description>A mobile device must be enrolled for a specific user by the administrator of the MDM prior to being used in the Enterprise network by the user.</description>
          <objective-refer ref="O.APPLY_POLICY">
            <rationale>The <abbr linkend="TOE"/> enrolls mobile devices for specific users with policy through the application 
              of O.APPLY_POLICY</rationale>
          </objective-refer>
        </OSP>
        <OSP id="P.NOTIFY"><!-- MDM -->
          <description>The mobile user must immediately notify the administrator if a mobile device is lost or stolen so that the 
            administrator may apply remediation actions via the MDM system.</description>
          <objective-refer ref="O.APPLY_POLICY">
            <rationale>The <abbr linkend="TOE"/> provides the capability for the administrator to apply remediation actions via the MDM 
            system through policy, which is applied through O.APPLY_POLICY.</rationale>
          </objective-refer>
        </OSP>
      </OSPs>
    </section>
  </chapter>
  <chapter title="Security Objectives" id="objectives">
    <!-- Kim: Is there a reason why you included all the additional SFRs?? -->
    <section id="TOEobjectives" title="Security Objectives for the TOE">
      <SOs>
        <SO id="O.ACCOUNTABILITY">
          <description>The <abbr linkend="TOE"/> must provide logging facilities, which record management actions undertaken by its administrators.</description>
          <!--  <component-refer ref="FAU_ALT_EXT.1"/>-->
          <component-refer ref="FAU_ALT_EXT.2"/> <!-- Good, TOE SFR -->
          <!--  <component-refer ref="FAU_GEN.1(1)"/>-->
          <component-refer ref="FAU_GEN.1(2)"/> <!-- Good, TOE SFR -->
          <!--  <component-refer ref="FAU_NET_EXT.1"/>-->
          <!--  <component-refer ref="FAU_SAR.1"/>-->
          <!--  <component-refer ref="FAU_SEL.1"/>-->
          <component-refer ref="FAU_SEL.1(2)"/> <!-- Good, TOE SFR -->
          <!--  <component-refer ref="FAU_STG_EXT.1"/>-->
          <!-- <component-refer ref="FAU_STG_EXT.2"/>    -->     
          <consistency-rationale></consistency-rationale>
        </SO>
        <SO id="O.APPLY_POLICY">
          <description>The <abbr linkend="TOE"/> must facilitate configuration and enforcement of enterprise security policies on mobile devices via interaction with the mobile OS and the MDM Server. This will include the initial enrollment of the device into management, through its entire lifecycle, including policy updates and its possible unenrollment from management services.</description>
          <!--  <component-refer ref="FAU_ALT_EXT.1"/>
          <component-refer ref="FAU_GEN.1(1)"/>
          <component-refer ref="FAU_GEN.1(2)"/>
          <component-refer ref="FAU_NET_EXT.1"/>
          <component-refer ref="FAU_SAR.1"/>
          <component-refer ref="FAU_SEL.1"/>
          <component-refer ref="FAU_STG_EXT.1"/>
          <component-refer ref="FAU_STG_EXT.2"/>-->
          <component-refer ref="FAU_STG_EXT.3 (optional)"/> <!-- Good, TOE Obj SFR -->
          <component-refer ref="FIA_ENR_EXT.2"/> <!-- Good, TOE SFR -->
          <!-- <component-refer ref="FMT_MOF_EXT.1"/> -->
          <component-refer ref="FMT_POL_EXT.2"/> <!-- Good, TOE SFR -->
          <!--  <component-refer ref="FMT_SMF_EXT.1"/>-->
          <!-- <component-refer ref="FMT_SMF_EXT.2"/> -->
          <component-refer ref="FMT_SMF_EXT.3"/> <!-- Good, TOE SFR -->
          <component-refer ref="FMT_UNR_EXT.1"/> <!-- Good, TOE SFR -->
          <!-- <component-refer ref="FTA_TAB.1"/> -->
          <consistency-rationale></consistency-rationale>
        </SO>
        <SO id="O.DATA_PROTECTION_TRANSIT">
          <description>Data exchanged between the MDM Server and the MDM Agent must be protected from being monitored, accessed, or altered.</description>
          <!-- <component-refer ref="FAU_STG_EXT.1"/> -->
          <component-refer ref="FCS_CKM_EXT.4 (from MDM/MDF Base-PP)"/>  <!-- Good, MDM/MDF Base -->
          <component-refer ref="FCS_CKM.1 (from MDM/MDF Base-PP)"/> <!-- Good, MDM/MDF Base -->
          <component-refer ref="FCS_CKM.2 (from MDM Base-PP)"/> <!-- Good, MDM Base -->
          <component-refer ref="FCS_CKM.2(1) (from MDF Base-PP)"/> <!-- Good, MDF Base -->
          <!--  <component-refer ref="FCS_CKM.2(2)"/>
          <component-refer ref="FCS_CKM_EXT.8"/>-->
          <component-refer ref="FCS_COP.1(*) (from MDM/MDF Base-PP)"/> <!-- Good, MDM/MDF Base -->
          <component-refer ref="FCS_DTLSS_EXT.1 (from TLS Package)"/> <!-- Good, MDM/MDF Base -->
          <component-refer ref="FCS_DTLSC_EXT.1 (from TLS Package)"/> <!-- Good, MDM/MDF Base -->
          <component-refer ref="FCS_HTTPS_EXT.1 (from MDM/MDF Base)"/> <!-- Good, MDM/MDF Base -->
          <!-- <component-refer ref="FCS_IPSEC_EXT.1"/>
          <component-refer ref="FCS_IV_EXT.1"/> -->
          <component-refer ref="FCS_RBG_EXT.1 (from MDM/MDF Base)"/> <!-- Good, MDM/MDF Base -->
          <!-- <component-refer ref="FCS_RBG_EXT.2"/>
          <component-refer ref="FCS_RBG_EXT.3"/>
          <component-refer ref="FCS_SRV_EXT.1"/>
          <component-refer ref="FCS_SRV_EXT.2"/>
          <component-refer ref="FCS_SSHS_EXT.1"/>
          <component-refer ref="FCS_STG_EXT.2"/>  -->         
          <component-refer ref="FCS_TLSC_EXT.1 (from TLS Package)"/> <!-- Good, MDM/MDF -->
          <component-refer ref="FCS_TLSC_EXT.2 (from TLS Package)"/> <!-- Good, MDM/MDF -->
          <component-refer ref="FCS_TLSS_EXT.1 (from TLS Package)"/> <!-- Good, MDM/MDF -->
          <component-refer ref="FCS_TLSS_EXT.2 (from TLS Package)"/> <!-- Good, MDM/MDF -->
          <!-- <component-refer ref="FDP_BLT_EXT.1"/>
          <component-refer ref="FDP_IFC_EXT.1"/>
          <component-refer ref="FDP_STG_EXT.1"/>
          <component-refer ref="FDP_UPC_EXT.1"/>
          <component-refer ref="FIA_BLT_EXT.1"/>
          <component-refer ref="FIA_BLT_EXT.2"/>
          <component-refer ref="FIA_BLT_EXT.3"/>
          <component-refer ref="FIA_BLT_EXT.4"/>
          <component-refer ref="FIA_BLT_EXT.5"/>
          <component-refer ref="FIA_BLT_EXT.6"/> -->
          <component-refer ref="FIA_X509_EXT.1(*) (from MDM/MDF Base)"/> <!-- Good, MDM/MDF Base -->
          <component-refer ref="FIA_X509_EXT.2 (from MDM/MDF Base)"/> <!-- Good, MDM/MDF Base -->
          <component-refer ref="FIA_X509_EXT.3 (from MDM/MDF Base)"/> <!-- Good, MDM/MDF Base -->
          <component-refer ref="FIA_X509_EXT.4 (from MDM Base)"/> <!-- Good, MDM Base -->
          <!-- <component-refer ref="FIA_X509_EXT.5"/>
          <component-refer ref="FPT_BLT_EXT.1"/> -->
          <component-refer ref="FPT_ITT.1 (refined from MDM Base-PP)"/> <!-- Good, applies to agent if extend from MDM -->
          <component-refer ref="FPT_NET_EXT.1 (optional)"/> <!-- Good, TOE Obj SFR -->
          <!--<component-refer ref="FTP_BLT_EXT.1"/>-->
          <!--<component-refer ref="FTP_BLT_EXT.2"/>-->
          <!--<component-refer ref="FTP_ITC.1(*)"/> -->
          <component-refer ref="FTP_ITC_EXT.1 (refined from MDF Base-PP)"/> <!-- Good, modified MDF -->
          <component-refer ref="FTP_TRP.1(*) (from MDM Base-PP, TOE SFR for MDF)"/> <!-- Good, added for MDF -->
          <consistency-rationale></consistency-rationale>
        </SO>
        <!-- The following SOs were taken from MDF b/c for that SFRs it also apply to agent, if agent extends MDF. They do not map to any  -->
        <!--  <SO id="O.INTEGRITY">
          <description><htm:b>Mobile Device Integrity</htm:b><htm:br/><htm:br/>
            To ensure the integrity of the Mobile Device is maintained conformant <abbr linkend="TOE"/>s will perform self-tests to ensure the integrity of critical functionality, software/firmware and data has been maintained. The user shall be notified of any failure of these self-tests. This will protect against the threat T.PERSISTENT.
            <htm:br/><htm:br/>
            To address the issue of an application containing malicious or flawed code (T.FLAWAPP), the integrity of downloaded updates to software/firmware will be verified prior to installation/execution of the object on the Mobile Device. In addition, the <abbr linkend="TOE"/> will restrict applications to only have access to the system services and data they are permitted to interact with. The <abbr linkend="TOE"/> will further protect against malicious applications from gaining access to data they are not authorized to access by randomizing the memory layout.
          </description>
          <component-refer ref="FPT_TST_EXT.1"/>
          <consistency-rationale></consistency-rationale>
        </SO>-->
        <SO id="O.STORAGE">
          <description>
            To address the issue of loss of confidentiality of user data in the event of loss of a Mobile Device (T.PHYSICAL), conformant <abbr linkend="TOE"/>s will use platform provide key storage. The <abbr linkend="TOE"/> is expected to protect its persistent secrets and private keys. 
          </description> 
          <component-refer ref="FCS_STG_EXT.1 (refined from MDM Base-PP)"/>
          <component-refer ref="FCS_STG_EXT.4 (if MDF is Base-PP)"/> 
        <consistency-rationale></consistency-rationale>
        </SO> 
      </SOs>
    </section>
    <section id="objectivesEnvironment" title="Security Objectives for the Operational Environment">
      <!-- SCHEMA: Why does this section populate with "This module does not define any assumptions"?? -->
      <!-- SCHEMA: Why does it error on the SOE tags?? -->
      <SOEs>
        <SOE id="OE.DATA_PROPER_ADMIN">
          <description>TOE Administrators are trusted to follow and apply all administrator guidance in a trusted manner.</description>
        </SOE>
        <SOE id="OE.DATA_PROPER_USER">
          <description>Users of the mobile device are trained to securely use the mobile device and apply all guidance in a trusted manner.</description>
        </SOE>
        <SOE id="OE.IT_ENTERPRISE">
          <description>The Enterprise IT infrastructure provides security for a network that is available to the <abbr linkend="TOE"/> and mobile devices that prevents unauthorized access.</description>
        </SOE>
        <SOE id="OE.MOBILE_DEVICE_PLATFORM">
          <description>The MDM Agent relies upon the trustworthy mobile platform and hardware to provide policy enforcement as well as cryptographic services and data protection. The mobile platform provides trusted updates and software integrity verification of the MDM Agent.</description>
        </SOE>
        <SOE id="OE.WIRELESS_NETWORK">
          <description>A wireless network will be available to the mobile devices.</description>
        </SOE>
      </SOEs>
    </section>   
    <section title="Security Objectives Rationale" id="rationale">
      <!-- Note: This section is populated from the rationale tags in the previous sections.  -->
      <!-- NIAP: Should we map the treats the module uses from the base PP?? -->
    </section>
  </chapter>
  <chapter id="sfr" title="Security Requirements">
    <base-pp name="Mobile Device Fundamentals" product="Mobile Device" short="MDF" url="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=417&amp;id=417" xmlurl="https://raw.githubusercontent.com/commoncriteria/mobile-device/master/input/mobile-device.xml">
      <!--  If this <abbr linkend="PP-Module"/> is extending the MDF <abbr linkend="PP"/>, the MDM Agent is expected to utilize a number of security functions implemented by the mobile device and evaluated against the base <abbr linkend="PP"/>. This security functionality includes FCS_CKM.1, FCS_CKM.2(1), FCS_CKM_EXT.4, FCS_COP.1(*), FCS_RBG_EXT.1, FCS_TLSC_EXT.1, FIA_X509_EXT.1, FIA_X509_EXT.2, FIA_X509_EXT.3, FPT_TST_EXT.1, FCS_DTLS_EXT.1, and FCS_HTTPS_EXT.1.-->
      <modified-sfrs>       
        <subsection id="trust-path-ftp" title="Trusted Path/Channels (FTP)">
         <!-- TODO: Fix this area -->
          <!--  If the <abbr linkend="PP-Module"/> extends the MDF <abbr linkend="PP"/>, the communication channel between the Agent and the Server is external to the <abbr linkend="TOE"/> and FTP_ITC_EXT.1 in the MDF <abbr linkend="PP"/> should be modified as below.-->
          <f-component id="ftp_itc_ext.1" name="Trusted Channel Communication">
            <consistency-rationale></consistency-rationale>
            <f-element id="ftp_itc_ext.1.1">
              <title>The TSF shall use                
                <selectables>
                  <selectable>TLS</selectable>
                  <selectable>DTLS</selectable>
                  <selectable>HTTPS</selectable>
                </selectables>
                to provide a communication channel between itself and another trusted IT product that is logically distinct from other communication channels, provides assured identification of its end points, protects channel data from disclosure, and detects modification of the channel data.</title>
              <note role="application">
                The intent of this requirement is to protect the communications channel between MDM Server and Agent, post enrollment. <linkref linkend="FTP_TRP.1(2)"/> is to protect the communications channel between MDM Server and Agent during enrollment. <htm:br/><htm:br/>
                This requirement is to ensure that the transmission of any audit logs, mobile device information data (software version, hardware model, and application versions), and configuration data collected by the MDM Agent and sent from the MDM Agent to the MDM Server, when commanded, or at configurable intervals, is properly protected. This trusted channel also protects any commands and policies sent by the MDM Server to the MDM Agent. Either the MDM Agent or the MDM Server is able to initiate the connection.<htm:br/><htm:br/>
                This requirement is refined from the base <abbr linkend="PP"/>; the mobile device is required to perform the mandated cryptographic protocols as in the base <abbr linkend="PP"/> for communication channels mandated in the MDF <abbr linkend="PP"/>. The <abbr linkend="ST"/> author must select one of TLS, DTLS, or HTTPS in order to establish and maintain a trusted channel between the MDM Agent and the MDM Server. Only TLS, DTLS, or HTTPS are acceptable for this trusted channel.<htm:br/><htm:br/>
                Since this requirement is only for the case when the <abbr linkend="PP-Module"/> builds on MDF PP and in this case it is expected that the MDM Agent will be a native part of the mobile operating system, it is expected that the MDM Agent will utilize the mobile device's implementation of the selected protocols. HTTPS (FCS_HTTPS_EXT.1) and TLS (FCS_TLSC_EXT.1) are already mandatory for a MDF ST. If "TLS" is selected the following selections from the TLS Functional Package shall be made:
                <htm:ul>
                  <htm:li>FCS_TLS_EXT.1: 
                    <htm:ul>
                      <htm:li>TLS must be selected</htm:li>
                      <htm:li>client must be selected</htm:li>
                    </htm:ul>
                  </htm:li>
                  <htm:li>FCS_TLSC_EXT.1.1:
                    <htm:ul>
                      <htm:li>TLS_RSA_WITH_AES_128_CBC_SHA cannot be selected</htm:li>
                      <htm:li>mutual authentication must be selected</htm:li>
                    </htm:ul>
                  </htm:li>
                </htm:ul>
                
                
                If DTLS is selected, then the appropriate SFRs from Appendix B in MDF shall be copied to the <abbr linkend="ST"/> if not already present.<htm:br/><htm:br/>
                Protocol, RBG, Certificate validation, algorithm, and similar services may be met with platform provided services. <htm:br/><htm:br/>
              </note>
            </f-element>
            <f-element id="ftp_itc_ext.1.2">
              <title>The <abbr linkend="TSF"/> shall permit the TSF and the MDM Server and <selectables>
                <selectable>MAS Server</selectable>
                <selectable>no other IT entities</selectable>
              </selectables> to initiate communication via the trusted channel.</title>           
              <note role="application">
                For all other use cases, the mobile device initiates the communication; however, for MDM Agents, the MDM Server may also initiate communication. This requirement replaces the requirement in the MDF <abbr linkend="PP"/>.</note>            
            </f-element>
            <f-element id="ftp_itc_ext.1.3">
              <title>The TSF shall initiate communication via the trusted channel for all communication between the MDM Agent and the MDM Server and <selectables>
                  <selectable>all communication between the MAS Server and the MDM Agent</selectable>
                  <selectable>no other communication</selectable>
                </selectables>             
              </title>
              <note role="application">
                This element is inherited from the MDF <abbr linkend="PP"/>; it is expected that Mobile Device will initiate the trusted channel between the MDM Agent and the MDM Server for administrative communication and may initiate other trusted channels to other trusted IT entities for other uses.</note>
              <aactivity>The following additional assurance activities shall be performed.
                <TSS/>The evaluator shall examine the <abbr linkend="TSS"/> to determine that the methods of Agent-Server 
                communication are indicated, along with how those communications are protected. The evaluator shall also 
                confirm that all protocols listed in the <abbr linkend="TSS"/> in support of remote <abbr linkend="TOE"/> 
                administration are consistent with those specified in the requirement, and are included in the requirements 
                in the <abbr linkend="ST"/>.<htm:br/><htm:br/>
               <!--  If "invoke platform-provided functionality" is selected, the evaluator shall examine the <abbr linkend="TSS"/> 
                of the <abbr linkend="ST"/> to verify that it describes (for each supported platform) 
                how this functionality is invoked (it should be noted that this may be through a mechanism that is not implemented 
                by the MDM Agent; nonetheless, that mechanism will be identified in the <abbr linkend="TSS"/> as part 
                of this evaluation activity). The API call for every element of this component should be documented.<htm:br/><htm:br/>--> 
                <Guidance/>The evaluator shall confirm that the operational guidance contains instructions for configuring the communication channel between the MDM Agent and the MDM Server and conditionally, the MAS Server for each supported method.<htm:br/><htm:br/>
                <Tests/>For each supported identifier type (excluding DNs), the evaluator shall repeat the following tests:<htm:br/><htm:br/>
                <testlist>
                  <test>The evaluators shall ensure that communications using each specified (in the operational guidance) Agent-Server communication method is tested during the course of the evaluation, setting up the connections as described in the operational guidance and ensuring that communication is successful.</test>
                  <test>The evaluator shall ensure, for each method of Agent-Server communication, the channel data is not sent in plaintext.</test>
                  <test>The evaluator shall ensure, for each communication channel with the MDM Server, that a protocol analyzer identifies the traffic as the protocol under testing.</test>
                </testlist>
                Further assurance activities are associated with the specific protocols.
              </aactivity>
            </f-element>
          </f-component>
        </subsection>  
      </modified-sfrs>
      <additional-sfrs>
        
        <subsection id="crypto-fcs" title="Cryptographic Support (FCS)">           
          <f-component id="fcs_stg_ext.4" name="Cryptographic Key Storage">
            <consistency-rationale></consistency-rationale>
            <f-element id="fcs_stg_ext.4.1">
              <title>The MDM Agent shall use the platform provided key storage for all persistent secret and private keys.</title>
              <note role="application">This requirement ensures that persistent secrets (credentials, secret keys) and private keys are stored securely when not in use by the mobile platform.</note>
              <aactivity>
                <TSS/>               
                The evaluator will verify that the <abbr linkend="TSS"/> lists each persistent secret (credential, secret key) and private key needed to meet the requirements in the <abbr linkend="ST"/>. For each of these items, the evaluator will confirm that the <abbr linkend="TSS"/> lists for what purpose it is used, and, for each platform listed as supported in the <abbr linkend="ST"/>, how it is stored. The evaluator shall verify that the Agent calls a platform-provided API to store persistent secrets and private keys.
              </aactivity>
            </f-element>
          </f-component>     
        </subsection>

        <subsection id="trust-path-enroll" title="Trusted Path">        
          <f-component id="ftp_trp.1(2)" name="Trusted Path (for Enrollment)">
            <consistency-rationale></consistency-rationale>
            <f-element id="ftp_trp.1.1(2)">
              <title>The MDM Agent shall <selectables>
                <selectable>invoke platform-provided functionality</selectable>
                <selectable>implement functionality</selectable>
              </selectables> to use <selectables>
                <selectable id="TRP_TLS_2">TLS</selectable>
                <selectable id="TRP_HTTPS_2">HTTPS</selectable>
              </selectables> to provide a trusted communication path between itself and another trusted IT product that is logically distinct 
                from other communication paths and provides assured identification of its endpoints and protection of the 
                communicated data from disclosure and detection of modification of the communicated data from 
                [modification, disclosure].</title>
            </f-element>
            <f-element id="ftp_trp.1.2(2)">
              <title>The TSF shall<selectables>
                <selectable>invoke platform-provided functionality</selectable>
                <selectable>implement functionality</selectable>
              </selectables> to permit <!-- ToDo: Why MD users and not the agent? -->MD users to initiate communication via the trusted path.</title>
        <!--TODO free the TOE for MD here! -->      
            </f-element>
            <f-element id="ftp_trp.1.3(2)">
              <title>The TSF shall <selectables>
                <selectable>invoke platform-provided functionality</selectable>
                <selectable>implement functionality</selectable>
              </selectables> to require the use of the trusted path for [all MD user actions].             
              </title>
              <!--TODO need to fix references in this note! -->
              <note role="application">
                This requirement ensures that authorized MD users initiate all communication with 
                the <abbr linkend="TOE"/> via a trusted path, and that all communications with the <abbr linkend="TOE"/> by 
                MD users is performed over this path. The purpose of this connection is for enrollment by the MD user. The 
                data passed in this trusted communication channel are encrypted as defined the protocol chosen in the first 
                selection. The <abbr linkend="ST"/> author chooses the mechanism or mechanisms supported by the 
                <abbr linkend="TOE"/>.<htm:br/><htm:br/>
                If "TLS" is selected the TLS Functional Package must be included in the <abbr linkend="ST"/>, 
                with the following selections made:
                <htm:ul>
                  <htm:li>FCS_TLS_EXT.1: 
                    <htm:ul>
                      <htm:li>TLS must be selected</htm:li>
                      <htm:li>client must be selected</htm:li>
                    </htm:ul>
                  </htm:li>
                  <htm:li>FCS_TLSC_EXT.1.1:
                    <htm:ul>
                      <htm:li>TLS_RSA_WITH_AES_128_CBC_SHA cannot be selected</htm:li>
                    </htm:ul>
                  </htm:li>
                </htm:ul>
              </note>
              <aactivity>
                <TSS/>The evaluator shall examine the <abbr linkend="TSS"/> to determine that the methods of remote enrollment 
                are indicated, along with how those communications are protected. The evaluator shall also confirm that all protocols 
                listed in the <abbr linkend="TSS"/> in support of enrollment are consistent with those specified in the requirement, 
                and are included in the requirements in the <abbr linkend="ST"/>.<htm:br/><htm:br/>
                If "invoke platform-provided functionality" is selected, the evaluator shall examine the <abbr linkend="TSS"/> of 
                the <abbr linkend="ST"/> to verify that it describes (for each supported platform) how this functionality is invoked 
                (it should be noted that this may be through a mechanism that is not implemented by the MDM Agent; nonetheless, that 
                mechanism will be identified in the <abbr linkend="TSS"/> as part of this evaluation activity).<htm:br/><htm:br/>
                <Guidance/>The evaluator shall confirm that the operational guidance contains instructions for establishing the 
                enrollment sessions for each supported method.<htm:br/><htm:br/>
                <Tests/>For each <abbr linkend="MDM"/> Agent/platform listed as supported in the <abbr linkend="ST"/>: <testlist>
                  <test>The evaluators shall ensure that communications using each specified (in the operational guidance) enrollment 
                    method is tested during the course of the evaluation, setting up the connections as described in the operational 
                    guidance and ensuring that communication is successful.</test>
                  <test>For each method of enrollment supported, the evaluator shall follow the operational guidance to ensure that 
                    there is no available interface that can be used by a remote user to establish enrollment sessions without 
                    invoking the trusted path.</test><!--platform?-->
                  <test>The evaluator shall ensure, for each method enrollment, the channel data is not sent in plaintext. </test>
                </testlist> Further assurance activities are associated with the specific protocols.             
              </aactivity>
            </f-element>
          </f-component>     
        </subsection>    
      </additional-sfrs>
      <con-toe></con-toe>
      <con-sec-prob></con-sec-prob>
      <con-obj></con-obj>
      <con-op-en></con-op-en>
    </base-pp>
    
    <base-pp name="Mobile Device Management" product="MDM Server" short="MDM" url="https://www.niap-ccevs.org/Profile/Info.cfm?PPID=392&amp;id=392" xmlurl="https://raw.githubusercontent.com/commoncriteria/mdm/master/input/mdm.xml">
     
        <!--  If this <abbr linkend="PP-Module"/> is extending the MDM <abbr linkend="PP"/>, the Agent is part of the MDM <abbr linkend="TOE"/> and any requirements on the MDM <abbr linkend="TOE"/> also apply to the MDM Agent. These security functions include FCS_CKM.1, FCS_CKM.2, FCS_CKM_EXT.4, FCS_COP.1(*), FCS_RBG_EXT.1, FIA_X509_EXT.1, FIA_X509_EXT.2, FIA_X509_EXT.3, FIA_X509_EXT.4, FCS_DTLS_EXT.1, and FCS_HTTPS_EXT.1. The <abbr linkend="ST"/> author should iterate the requirements in the MDM <abbr linkend="PP"/> for each Agent in order to make the appropriate selections for each agent.-->   
      <!-- DONE: above SFRs manadatory or feature dependent for all components of the distributed TOE -->
      <modified-sfrs>        
        <subsection id="mdm-crypto-fcs" title="Cryptographic Support (FCS)">          
          <f-component id="fcs_stg_ext.1" name="Cryptographic Key Storage">
            <consistency-rationale></consistency-rationale>
            <f-element id="fcs_stg_ext.1.1">
              <title>The MDM Agent shall use the platform provided key storage for all persistent secret and private keys.</title>
              <note role="application">This requirement ensures that persistent secrets (credentials, secret keys) and private keys are stored securely when not in use by the mobile platform.</note>
              <aactivity>
                <TSS/> 
                The evaluator will verify that the <abbr linkend="TSS"/> lists each persistent secret (credential, secret key) and private key needed to meet the requirements in the <abbr linkend="ST"/>. For each of these items, the evaluator will confirm that the <abbr linkend="TSS"/> lists for what purpose it is used, and, for each platform listed as supported in the <abbr linkend="ST"/>, how it is stored. The evaluator shall verify that the Agent calls a platform-provided API to store persistent secrets and private keys.
              </aactivity>
            </f-element>
          </f-component>         
        </subsection>
        <subsection id="fpt" title="Protection of the TSF (FPT)">
          <f-component name="Internal TOE TSF Data Transfer" id="FPT_ITT.1">
            <consistency-rationale></consistency-rationale>
            <f-element id="FPT_ITT.1.1">
              <title>The TSF shall <selectables>
                <selectable>invoke platform-provided functionality</selectable>
                <selectable>implement functionality</selectable>             
              </selectables> to protect all data from [disclosure and modification] through use of <selectables>
                <selectable>TLS</selectable>
                <selectable>HTTPS</selectable>
                <selectable>DTLS</selectable>
              </selectables> when it is transferred between separate parts of the TOE.</title>
              <note>               
                The intent of this requirement is to protect the communications channel between MDM Server and Agent, post enrollment. <linkref linkend="FTP_TRP.1(2)"/> from the base <abbr linkend="PP"/> is to protect the communications channel between MDM Server and Agent during enrollment. <htm:br/><htm:br/>
                This requirement is to ensure that the transmission of any audit logs, mobile device information data (software version, hardware model, and application versions), and configuration data collected by the MDM Agent and sent from the MDM Agent to the MDM Server, when commanded, or at configurable intervals, is properly protected. This trusted channel also protects any commands and policies sent by the MDM Server to the MDM Agent. Either the MDM Agent or the MDM Server is able to initiate the connection.<htm:br/><htm:br/>
                This requirement is refined from the base <abbr linkend="PP"/>. Since this requirement is only for the case when the <abbr linkend="PP-Module"/> builds on MDM PP and in this case it is expected that the MDM Agent will be a third party application provided by the MDM Server, it is acceptable for the MDM Agent to utilize the protocol implementations from the mobile device. If that is the case then "invoke platform-provided functionality" shall be selected. If the MDM agent implements the protocol itself, then "implement functionality" shall be selected.<htm:br/><htm:br/>
                If "HTTPS" is selected the appropriate selection-based SFRs from Appendix B of MDM PP shall be included in the ST, if not already present.<htm:br/><htm:br/>
                If "TLS" or "DTLS" is selected the TLS Functional Package must be included in the <abbr linkend="ST"/>, with the following selections made:
                <htm:ul>
                  <htm:li>FCS_TLS_EXT.1: 
                    <htm:ul>
                      <htm:li>either TLS or DTLS is selected depending on the selection made in FPT_ITT.1.1</htm:li>
                      <htm:li>either client or server is selected as appropriate</htm:li>
                    </htm:ul>
                  </htm:li>
                  <htm:li>FCS_TLSC_EXT.1.1 or FCS_TLSS_EXT.1.1 (as appropriate):
                    <htm:ul>
                      <htm:li>TLS_RSA_WITH_AES_128_CBC_SHA cannot be selected</htm:li>
                      <htm:li>mutual authentication must be selected</htm:li>
                    </htm:ul>
                  </htm:li>
                </htm:ul>          
                Protocol, RBG, Certificate validation, algorithm, and similar services may be met with platform provided services. <htm:br/><htm:br/>
              </note>
              <aactivity>
                <TSS/>The evaluator shall examine the <abbr linkend="TSS"/> to determine that the methods and protocols used to protect distributed <abbr linkend="TOE"/> components are described. The evaluator shall also confirm that all protocols listed in the <abbr linkend="TSS"/> in support of <abbr linkend="TOE"/> administration are consistent with those specified in the requirement, and are included in the requirements in the <abbr linkend="ST"/>.<htm:br/><htm:br/>
                If "invoke platform-provided functionality" is selected, the evaluator shall examine the <abbr linkend="TSS"/> of the <abbr linkend="MDM"/> Server's <abbr linkend="ST"/> to verify that it describes (for each supported platform) how this functionality is invoked (it should be noted that this may be through a mechanism that is not implemented by the <abbr linkend="MDM"/> Server; nonetheless, that mechanism will be identified in the <abbr linkend="TSS"/> as part of this evaluation activity).<htm:br/><htm:br/>
                <Guidance/>The evaluator shall confirm that the operational guidance contains instructions for establishing the communication paths for each supported method.<htm:br/><htm:br/>
                <Tests/>
                <testlist>
                  <test>The evaluators shall ensure that communications using each specified (in the operational guidance) communication method is tested during the course of the evaluation, setting up the connections as described in the operational guidance and ensuring that communication is successful.</test>
                  <test>The evaluator shall ensure, for each method of communication, the channel data is not sent in plaintext.</test>
                </testlist> Further assurance activities are associated with the specific protocols.
              </aactivity>
            </f-element>          
          </f-component>        
        </subsection>
      </modified-sfrs>
      <additional-sfrs></additional-sfrs>
      <con-toe></con-toe>
      <con-sec-prob></con-sec-prob>
      <con-obj></con-obj>
      <con-op-en></con-op-en>
    </base-pp>

    <man-sfrs>
      <!-- SCHEMA: The mandatory SFRs are not mapped to the Consistency of Requirements section (6.1.4 and 6.2.4) -->
      <subsection id="fau" title="Security Audit (FAU)">
        <f-component id="fau_alt_ext.2" name="Agent Alerts">
          <consistency-rationale>test</consistency-rationale>
          <f-element id="fau_alt_ext.2.1">
            <title>The MDM Agent shall provide an alert via the trusted channel to the MDM Server in the event of any of the following audit events:
              <htm:ul>
                <htm:li>successful application of policies to a mobile device</htm:li>
                <htm:li>
                  <selectables>
                    <selectable>receiving</selectable>
                    <selectable>generating</selectable>
                  </selectables> periodic reachability events;
                </htm:li>
                <selectables linebreak="yes">
                  <selectable>change in enrollment state</selectable>
                  <selectable>failure to install an application from the MAS Server</selectable>
                  <selectable>failure to update an application from the MAS Server</selectable>
                  <selectable><assignable>other events</assignable></selectable> 
                  <selectable>no other events</selectable>
                </selectables>
              </htm:ul>
            </title>
            <note role="application">
              The trusted channel is defined in FPT_ITT.1 if Agent extends MDM Server and FTP_ITC_EXT.1 if Agent extends MDF <abbr linkend="PP"/>. “Alert” in this requirement could be as simple as an audit record or a notification. If any prior alerts exist in the queue, per FAU_ALT_EXT.2.2, those alerts shall be sent when the trusted channel is available.<htm:br/><htm:br/>
              This requirement is to ensure that the MDM Agent shall notify the MDM Server whenever one of the events listed above occurs. Lack of receipt of a successful policy installation indicates the failure of the policy installation.<htm:br/><htm:br/>
              The periodic reachability events ensure that either the MDM Agent responds to MDM Server polls to determine device network reachability, or the MDM Agent can be configured to regularly notify the Server that it is reachable. The <abbr linkend="ST"/> author must select “receiving” in the first case and “generating” in the second. The corresponding requirement for the MDM Server is FAU_NET_EXT.1 in the MDM <abbr linkend="PP"/>.<htm:br/><htm:br/>
              The <abbr linkend="ST"/> author must either assign further events or select the “no other events” option. Note that alerts may take time to reach the MDM Server, or not arrive, due to poor connectivity.  <htm:br/><htm:br/>
            </note>
            <aactivity>
              <TSS/>
              The evaluator shall examine the <abbr linkend="TSS"/> and verify that it describes how the alerts are implemented.<htm:br/><htm:br/>
              The evaluator ensures that the <abbr linkend="TSS"/> describes how the candidate policy updates are obtained; and the actions that take place for successful (policy update installed) and unsuccessful (policy update not installed) cases. The software components that are performing the processing must also be identified in the <abbr linkend="TSS"/> and verified by the evaluator.<htm:br/><htm:br/>
              The evaluator also ensures that the <abbr linkend="TSS"/> describes how reachability events are implemented, and if configurable are selected in FMT_SMF_EXT.3.2. The evaluator verifies that this description clearly indicates who (MDM Agent or MDM Server) initiates reachability events.<htm:br/><htm:br/>
              <Tests/>
              <testlist>
                <test>The evaluator shall perform a policy update from the test environment MDM server. The evaluator shall verify the MDM Agent accepts the update, makes the configured changes, and reports the success of the policy update back to the MDM Server.</test>
                <test>The evaluator shall perform each of the actions listed in FAU_ALT_EXT.1.1 and verify that the alert does in fact reach the MDM Server.</test>
                <test>The evaluator shall configure the MDM Agent to perform a network reachability test, both with and without such connectivity and ensure that results reflect each.</test>
              </testlist>
            </aactivity>
          </f-element>
          <f-element id="fau_alt_ext.2.2">
            <title>The MDM Agent shall queue alerts if the trusted channel is not available.</title>
            <note role="application">If the trusted channel is not available, alerts shall be queued. When the trusted channel becomes available, the queued alerts shall be sent.</note>
            <aactivity>
              <TSS/> The evaluator shall ensure that the <abbr linkend="TSS"/> describes under what circumstances, if any, the alert may not be generated (e.g., the device is powered off or disconnected from the trusted channel), how alerts are queued, and the maximum amount of storage for queued messages.<htm:br/><htm:br/>
              <Tests/>The evaluator shall remove network connectivity from the MDM Agent and generate an alert/event as defined in FAU_ALT_EXT.2.1. The evaluator shall restore network connectivity to the MDM Agent and verify that the alert generated while the <abbr linkend="TOE"/> was disconnected is sent by the MDM Agent upon re-establishment of the connectivity.<htm:br/><htm:br/>
            </aactivity>
          </f-element>
        </f-component>
        <f-component id="fau_gen.1(2)" name="Audit Data Generation">         
          <consistency-rationale></consistency-rationale>                  
          <f-element id="fau_gen.1.1(2)">
            <title>
              The MDM Agent shall <selectables>
                <selectable>invoke platform-provided functionality</selectable>
                <selectable>implement functionality</selectable>
              </selectables> to generate an MDM Agent audit record of the following auditable events:
              <htm:ul>
                <htm:li>startup and shutdown of the MDM Agent</htm:li>
                <htm:li>Change in MDM policy</htm:li>
                <htm:li>any modification commanded by the MDM Server</htm:li>
                <htm:li>Specifically defined auditable events listed in Table 1</htm:li>
                <htm:li><assignable>other events</assignable></htm:li>
              </htm:ul>
            </title>
          <note role="application">
              This requirement outlines the information to be included in the MDM Agent’s audit records. The <abbr linkend="ST"/> 
              author can include other auditable events directly in the table in FAU_GEN.1.1; they are not limited to the list 
              presented.<htm:br/><htm:br/>
              The change of the MDM policy must minimally indicate that the policy changed. The event record need not contain the 
              differences between the prior policy and the new policy. Modifications commanded by the MDM Server are those commands 
              listed in FMT_SMF.1.1.<htm:br/><htm:br/>
              The selection for the FMT_UNR_EXT.1 auditable event in Table 1 corresponds to the selection in FMT_UNR_EXT.1. If “apply 
              remediation actions” is selected in FMT_UNR_EXT.1, then the <abbr linkend="ST"/> author selects “attempt to unenroll” 
              in FAU_GEN.1.1(2) Table 1 for FMT_UNR_EXT.1; otherwise, "none" is selected.
            </note>
            <aactivity>
              <TSS/>The evaluator shall check the <abbr linkend="TSS"/> and ensure that it provides a format for audit records. 
              Each audit record format type must be covered, along with a brief description of each field. <htm:br/><htm:br/>
              If "invoke platform-provided functionality" is selected, the evaluator shall examine the <abbr linkend="TSS"/> of the 
              <abbr linkend="ST"/> to verify that it describes (for each supported platform) how this functionality is invoked (it 
              should be noted that this may be through a mechanism that is not implemented by the MDM Agent; nonetheless, that 
              mechanism will be identified in the <abbr linkend="TSS"/> as part of this evaluation activity).<htm:br/><htm:br/>
              <Tests/>
              The evaluator shall use the <abbr linkend="TOE"/> to perform the auditable events defined in Table 1 and observe that 
              accurate audit records are generated with contents and formatting consistent with those described in the 
              <abbr linkend="TSS"/>. Note that this testing can be accomplished in conjunction with the testing of the security 
              mechanisms directly.
              <htm:table>
                <htm:TR>
                  <htm:TH>Requirement</htm:TH>
                  <htm:TH>Auditable Events</htm:TH>
                  <htm:TH>Additional Audit Record Contents</htm:TH>
                </htm:TR>
                <htm:TR>
                  <htm:TD>FAU_ALT_EXT.2</htm:TD>
                  <htm:TD>Type of alert.</htm:TD>
                  <htm:TD>No additional information.</htm:TD>
                </htm:TR>
                <htm:TR>
                  <htm:TD>FAU_GEN.1</htm:TD>
                  <htm:TD>None.</htm:TD>
                  <htm:TD>N/A</htm:TD>
                </htm:TR>
                
                <htm:TR>
                  <htm:TD>FAU_SEL.1</htm:TD>
                  <htm:TD>All modifications to the audit configuration that occur while the audit collection functions are operating.</htm:TD>
                  <htm:TD>No additional information.</htm:TD>
                </htm:TR>
                <htm:TR>
                  <htm:TD>FCS_STG_EXT.4/<htm:br/>
                    FCS_STG_EXT.1(1)</htm:TD>
                  <htm:TD>None.</htm:TD>
                  <htm:TD></htm:TD>
                </htm:TR>
                <htm:TR>
                  <htm:TD>FCS_TLSC_EXT.1</htm:TD>
                  <htm:TD>Failure to establish a TLS session.<htm:br/>Failure to verify presented identifier.<htm:br/>Establishment/termination of a TLS session.</htm:TD>
                  <htm:TD>Reason for failure.<htm:br/>Presented identifier and reference identifier.<htm:br/>Non-TOE endpoint of connection.</htm:TD>
                </htm:TR>
                <htm:TR>
                  <htm:TD>FIA_ENR_EXT.2</htm:TD>
                  <htm:TD>Enrollment in management.</htm:TD>
                  <htm:TD>Reference identifier of MDM Server.</htm:TD>
                </htm:TR>
                <htm:TR>
                  <htm:TD>FMT_POL_EXT.2</htm:TD>
                  <htm:TD>Failure of policy validation.</htm:TD>
                  <htm:TD>Reason for failure of validation.</htm:TD>
                </htm:TR>
                <htm:TR>
                  <htm:TD>FMT_SMF_EXT.3</htm:TD>
                  <htm:TD>Success or failure of function.</htm:TD>
                  <htm:TD>No additional information.</htm:TD>
                </htm:TR>
                <htm:TR>
                  <htm:TD>FMT_UNR_EXT.1.1</htm:TD>
                  <htm:TD>
                    
                    <selectables>
                      <selectable>Attempt to unenroll</selectable>
                      <selectable>none</selectable>
                    </selectables>
                  </htm:TD>
                  <htm:TD>No additional information.</htm:TD>
                </htm:TR>
                <htm:TR>
                  <htm:TD>FTP_ITC_EXT.1/<htm:br/>FPT_ITT_EXT.1</htm:TD>
                  <htm:TD>Initiation and termination of trusted channel.</htm:TD>
                  <htm:TD>Trusted channel protocol. Non-TOE endpoint of connection.</htm:TD>
                </htm:TR>
              </htm:table>
              <htm:center><htm:h4>Table 1: Auditable Events</htm:h4></htm:center>
              
            </aactivity>
          </f-element>
          <f-element id="fau_gen.1.2(2)">
            <title>The 
              <selectables>
                <selectable>TSF</selectable>
                <selectable>TOE platform</selectable>
              </selectables> shall record within each MDM Agent audit record at least the following information:
              <htm:ul>
                <htm:li>date and time of the event</htm:li>
                <htm:li>type of event</htm:li>
                <htm:li>subject identity</htm:li>
                <htm:li>(if relevant) the outcome (success or failure) of the event</htm:li>
                <htm:li>additional information in Table 1</htm:li> <!--HERE is this the correct table ref ? -->
                <htm:li><assignable>other audit relevant information</assignable></htm:li>
              </htm:ul></title>
            <note role="application">All audits must contain at least the information mentioned in FAU_GEN.1.2(2), but may contain more information which can be assigned. The <abbr linkend="ST"/> author shall identify in the <abbr linkend="TSS"/> which information of the audit record that is performed by the MDM Agent and that which is performed by the MDM Agent’s platform.</note>
            <aactivity>
              <TSS/>The evaluator shall check the <abbr linkend="TSS"/> and ensure that it provides a format for audit records. Each audit record format type must be covered, along with a brief description of each field.<htm:br/><htm:br/>
              <Tests/>When verifying the test results, the evaluator shall ensure the audit records generated during testing match the format specified in the administrative guide, and that the fields in each audit record have the proper entries.<htm:br/><htm:br/>
              Note that the testing here can be accomplished in conjunction with the testing of the security mechanisms directly.<htm:br/><htm:br/>
            </aactivity>
          </f-element>
        </f-component>
        <f-component id="fau_sel.1(2)" name="Security Audit Event Selection">
          <consistency-rationale></consistency-rationale>
          <f-element id="fau_sel.1.1(2)">
            
            <title> The <abbr linkend="TSF"/> shall <selectables>
              <selectable>invoke platform-provided functionality</selectable>
              <selectable>implement functionality</selectable>
              </selectables> to select the set of events to be audited from the set of all auditable events based on the 
              following attributes:
              <htm:ul>
                <htm:li>event type</htm:li>
                <htm:li>success of auditable security events</htm:li>
                <htm:li>failure of auditable security events</htm:li>
                <htm:li><assignable>other attributes</assignable></htm:li>
              </htm:ul></title>
            <note role="application">The intent of this requirement is to identify all criteria that can be selected to trigger an 
              audit event. For the <abbr linkend="ST"/> author, the assignment is used to list any additional criteria or “none”. 
              This selection may be configured by the MDM Server.</note>
            <aactivity>
              <TSS/>If "invoke platform-provided functionality" is selected, the evaluator shall examine the <abbr linkend="TSS"/> of 
              the <abbr linkend="ST"/> to verify that it describes (for each supported platform) how this functionality is invoked 
              (it should be noted that this may be through a mechanism that is not implemented by the MDM Agent; nonetheless, that 
              mechanism will be identified in the <abbr linkend="TSS"/> as part of this evaluation activity).<htm:br/><htm:br/>
              <Guidance/>The evaluator shall examine the operational guidance to determine that it contains instructions on how to 
              define the set of auditable events as well as explains the syntax for multi-value selection (if applicable). The 
              evaluator shall also verify that the operational guidance shall identify those audit records that are always recorded, 
              regardless of the selection criteria currently being enforced.<htm:br/><htm:br/>
              <Tests/>
              <testlist>
                <test>For each attribute listed in the requirement, the evaluator shall devise a test to show that selecting the attribute causes only audit events with that attribute (or those that are always recorded, as identified in the administrative guidance) to be recorded.</test>
                <test>[conditional]: If the TSF supports specification of more complex audit pre-selection criteria (e.g., multiple attributes, logical expressions using attributes) then the evaluator shall devise tests showing that this capability is correctly implemented. The evaluator shall also, in the test plan, provide a short narrative justifying the set of tests as representative and sufficient to exercise the capability.</test>
              </testlist>
            </aactivity>
          </f-element>
        </f-component>       
     </subsection>
      <subsection id="fia" title="Identification and Authentication (FIA)">
        <f-component id="fia_enr_ext.2" name="Enrollment of Mobile Device into Management">
          <consistency-rationale></consistency-rationale>
          <f-element id="fia_enr_ext.2.1">
            <title>The MDM Agent shall record the reference identifier of the MDM Server during the enrollment process.</title>
            <note role="application">The reference identifier of the MDM Server may be the Distinguished Name, Domain Name, and/or the IP address of the MDM Server. This requirement allows the specification of the information to be to be used to establish a network connection and the reference identifier for authenticating the trusted channel between the MDM Server and MDM Agent (FPT_ITT.1).</note>
            <aactivity>
              <TSS/>The evaluator shall examine the <abbr linkend="TSS"/> to verify that it describes which types of reference identifiers are acceptable and how the identifier is specified (e.g. preconfigured in the MDM Agent, by the user, by the MDM server, in a policy).<htm:br/>
              <Guidance/>The evaluator shall examine the operational guidance to verify that it describes how to configure reference identifier of the MDM Server’s certificate and, if different than the reference identifier, the Domain Name or IP address (for connectivity) of the MDM Server.<htm:br/>
              <Tests/>The evaluator shall follow the operational guidance to establish the reference identifier of the MDM server on the MDM Agent and in conjunction with other Assurance Activities verify that the MDM Agent can connect to the MDM Server and validate the MDM Server’s certificate.<htm:br/>
            </aactivity>
          </f-element>
        </f-component>
      </subsection>
      <subsection id="fmt" title="Security Management (FMT)">
        <f-component id="fmt_pol_ext.2" name="Trusted Policy Update">
          <consistency-rationale></consistency-rationale>
          <f-element id="fmt_pol_ext.2.1">
            <title>The MDM Agent shall only accept policies and policy updates that are digitally signed by the Enterprise.</title>
            <note role="application">The intent of this requirement is to cryptographically tie the policies to the enterprise that mandated the policy, not to protect the policies in transit (as they are already protected by FPT_ITT.1). This is especially critical for users who connect to multiple enterprises.<htm:br/><htm:br/>
              Policies must be digitally signed by the enterprise using the algorithms in FCS_COP.1(3).</note>
            <aactivity>
              <TSS/>The evaluator also ensures that the <abbr linkend="TSS"/> (or the operational guidance) describes how the candidate policies are obtained by the MDM Agent; the processing associated with verifying the digital signature of the policy updates; and the actions that take place for successful (signature was verified) and unsuccessful (signature could not be verified) cases. The software components that are performing the processing must also be identified in the <abbr linkend="TSS"/> and verified by the evaluators.<htm:br/><htm:br/>
              <Tests/>The evaluator shall perform a policy update from an available configuration interface (such as through a test MDM Server). The evaluator shall verify the update is signed and is provided to the MDM Agent. The evaluator shall verify the MDM Agent accepts the digitally signed policy. 
             <testlist>
               <test>The evaluator shall perform a policy update from an available configuration interface (such as through a test MDM Server). The evaluator shall verify the update is signed and is provided to the MDM Agent. The evaluator shall verify the MDM Agent accepts the digitally signed policy.<htm:br/><htm:br/>
                 The evaluator shall perform a policy update from an available configuration interface (such as through a test MDM Server). The evaluator shall provide an unsigned and an incorrectly signed policy to the MDM Agent. The evaluator shall verify the MDM Agent does not accept the digitally signed policy.</test>
             </testlist>            
            </aactivity>
          </f-element>
          <f-element id="fmt_pol_ext.2.2">
            <title>The MDM Agent shall not install policies if the policy-signing certificate is deemed invalid.</title>
            <aactivity>
                <TSS/>     
              <!-- TODO: Not really a TSS -->
              The assurance activity for this requirement is performed in conjunction with the assurance activity for FIA_X509_EXT.1 and FIA_X509_EXT.2 as defined in the base <abbr linkend="PP"/>s.</aactivity>
          </f-element>
        </f-component>
        <f-component id="fmt_smf_ext.3" name="Specification of Management Functions">
          <consistency-rationale></consistency-rationale>
          <f-element id="fmt_smf_ext.3.1">            
            <title>The MDM Agent shall be capable of interacting with the platform to perform the following functions:
              <htm:li>Import the certificates to be used for authentication of MDM Agent communications</htm:li>
              <htm:li><selectables>
                  <selectable>administrator-provided management functions in MDF <abbr linkend="PP"/></selectable>
                  <selectable>administrator-provided device management functions in MDM <abbr linkend="PP"/></selectable>
                  </selectables></htm:li>             
              <htm:li><selectables>
                  <selectable><assignable>additional functions</assignable></selectable>
                  <selectable> no additional functions</selectable>
              </selectables></htm:li>              
            </title>
            <note role="application">
              This requirement captures all the configuration functionality in the MDM Agent to configure the underlying Mobile Device with the configuration policies sent from the MDM Server to the Agent. The <abbr linkend="ST"/> author selects the base <abbr linkend="PP"/> (MDF <abbr linkend="PP"/> or MDM <abbr linkend="PP"/>) as the source of the management functions.<htm:br/><htm:br/>
              The administrator-provided management functions in MDF <abbr linkend="PP"/> are specified in Column 4 of Table 4 in MDF <abbr linkend="PP"/> and in FPT_TUD_EXT.1 (for version queries). The administrator-provided device management functions in MDM <abbr linkend="PP"/> are specified in FMT_SMF.1.1(1); the functions in the selection of FMT_SMF.1.1(1) in the MDM <abbr linkend="PP"/> are required to correspond to the functions available on the platforms supported by the MDM Agent.<htm:br/><htm:br/>
              The <abbr linkend="ST"/> author can add more commands and configuration policies by completing the assignment statement; the Mobile Device must support these additional commands or configuration policies.<htm:br/><htm:br/>
              The agent must configure the platform based on the commands and configuration policies received from the MDM Server. The <abbr linkend="ST"/> author shall not claim any functionality not provided by the supported Mobile Device(s). All selections and assignments performed by the <abbr linkend="ST"/> author in this requirement should match the selections and assignments of the validated Mobile Device <abbr linkend="ST"/>.</note>
            <aactivity>This assurance activity may be performed in conjunction with other assurance activities in the base <abbr linkend="PP"/>.<htm:br/><htm:br/>
              <TSS/>The evaluator shall verify that the any assigned functions are described in the <abbr linkend="TSS"/> and that these functions are documented as supported by the platform. The evaluator shall examine the <abbr linkend="TSS"/> to verify that any differences between management functions and policies for each supported Mobile Device are listed.<htm:br/><htm:br/>
              <Guidance/>
              The evaluator shall verify the AGD guidance includes detailed instructions for configuring each function in this requirement.<htm:br/><htm:br/>
              If the MDM Agent is a component of the MDM system (i.e. MDM Server is the base <abbr linkend="PP"/>), the evaluator shall verify, by consulting documentation for the claimed mobile device platforms, that the configurable functions listed for this Agent are supported by the platforms.<htm:br/><htm:br/>
              If the MDM Agent supports multiple interfaces for configuration (for example, both remote configuration and local configuration), the AGD guidance makes clear whether some functions are restricted to certain interfaces.<htm:br/><htm:br/>
              <Tests/> 
              <testlist>
                <test>In conjunction with the assurance activities in the base <abbr linkend="PP"/>, the evaluator shall attempt to configure each administrator-provided management function and shall verify that the Mobile Device executes the commands and enforces the policies.</test>
                <test>The evaluator shall configure the MDM Agent authentication certificate in accordance with the configuration guidance. The evaluator shall verify that the MDM Agent uses this certificate in performing the tests for FPT_ITT.1.</test>
                <test>(conditional) The evaluator shall design and perform tests to demonstrate that the assigned function may be configured and that the intended behavior of the function is enacted by the mobile device.</test> 
              </testlist>
            </aactivity>
          </f-element>
           <f-element id="fmt_smf_ext.3.2">
            <title>The MDM Agent shall be capable of performing the following functions:
              <htm:ul>
                <htm:li>Enroll in management</htm:li>
                <htm:li>Configure whether users can unenroll from management</htm:li>
                <htm:li>
                  <selectables>
                    <selectable>configure periodicity of reachability events</selectable>
                    <selectable><assignable>other management functions</assignable></selectable>
                    <selectable>no other functions</selectable>
                  </selectables></htm:li>
              </htm:ul></title>
            <note role="application">
              This requirement captures all of the configuration in the MDM Agent for configuration of itself.<htm:br/><htm:br/>
              If the MDM Agent is a part of the mobile device, enrollment is a single function both of the Agent and of the mobile device (FMT_SMF_EXT.3.1).<htm:br/><htm:br/>
              If the MDM Agent is an application developed separately from the mobile device, the MDM Agent performs the function “enroll the mobile device in management” (per FMT_SMF_EXT.3.1) by registering itself to the mobile device as a device administrator. The Agent itself is enrolled in management by configuring the MDM Server to which the Agent answers.<htm:br/><htm:br/>
              <!-- ToDo: Add application note for "configure whether users can unenroll from management, to include that if prevention of unenrollment is not supported, then remediation actions should by applied upon unenrollment. -->
              If the Agent generates periodic reachability events in FAU_ALT_EXT.2.1 and the periodicity of these events is configurable, “configure periodicity of reachability events” must be selected.</note>
            <aactivity>
              <TSS/> 
              The evaluator shall verify that the <abbr linkend="TSS"/> describes the methods in which the MDM Agent can be enrolled.<htm:br/><htm:br/>
              The <abbr linkend="TSS"/> description shall make clear if the MDM Agent supports multiple interfaces for enrollment and configuration (for example, both remote configuration and local configuration).            
              <Guidance/>
              The evaluator shall verify the AGD guidance includes detailed instructions for configuring each function in this requirement.<htm:br/><htm:br/>
              Additionally, the evaluator shall verify that the <abbr linkend="TSS"/> describes any management functions of the MDM Agent, if assigned.<htm:br/><htm:br/>
               <Tests/>
              <testlist>
                <test>In conjunction with other assurance activities, the evaluator shall attempt to enroll the MDM Agent in management with each interface identified in the <abbr linkend="TSS"/>, and verify that the MDM Agent can manage the device and communicate with the MDM Server.</test>
                <test>(conditional) In conjunction with the assurance activity for FAU_ALT_EXT.2.1, the evaluator shall configure the periodicity for reachability events for several configured time periods and shall verify that the MDM Server receives alerts on that schedule.</test>
                <test>(conditional) The evaluator shall design and perform tests to demonstrate that the assigned function may be configured and that the intended behavior of the function is enacted by the mobile device.</test>
              </testlist>
            </aactivity>
          </f-element>
        </f-component>
        <f-component id="fmt_unr_ext.1" name="User Unenrollment Prevention">
          <consistency-rationale></consistency-rationale>
          <f-element id="fmt_unr_ext.1.1">            
            <title>The MDM Agent shall provide a mechanism to enforce the following behavior upon an attempt to unenroll the mobile device from management:  
              <selectables>
                <selectable>prevent the unenrollment from occurring</selectable>
                <selectable>apply remediation actions</selectable>
              </selectables>
            </title>
            <note role="application">Unenrolling is the action of transitioning from the enrolled state to the unenrolled state. If preventing the user from unenrolling is configurable, administrators configure whether users are allowed to unenroll through the MDM Server.<htm:br/><htm:br/>
              For those configurations where unenrollment is allowed, for example a BYOD usage, the MDFPP describes remediation actions performed upon unenrollment, such as wiping enterprise data, in FMT_SMF_EXT.2.1; however, the MDM Agent is limited to those actions supported by the mobile device on which the Agent is operating.
            </note>
              <aactivity>
              <TSS/>
                The evaluator shall ensure that the <abbr linkend="TSS"/> describes the mechanism used to prevent users from unenrolling or the remediation actions applied when unenrolled.
                <Guidance/>
                The evaluator shall ensure that the administrative guidance instructs administrators in configuring the unenrollment prevention in each available configuration interface. If any configuration allows users to unenroll, the guidance also describes the actions that unenroll the Agent.
                <Tests/>
                <testlist>
                  <test>If ‘prevent the unenrollment from occurring’ is selected: The evaluator shall configure the Agent according to the administrative guidance for each available configuration interface, shall attempt to unenroll the device, and shall verify that the attempt fails.</test>
                <test>If ‘apply remediation actions’ is selected: If any configuration allows the user to unenroll, the evaluator shall configure the Agent to allow user unenrollment, attempt to unenroll, and verify that the remediation actions are applied.</test>
              </testlist>
            </aactivity>
          </f-element>
        </f-component>
      </subsection>
    </man-sfrs>
    <opt-sfrs></opt-sfrs>
    <sel-sfrs></sel-sfrs>
    <obj-sfrs>
      <!-- SCHEMA: SD does not include this EAs -->
      <subsection id="fau" title="Security Audit (FAU)">
        <f-component id="fau_stg_ext.3" name="Security Audit Event Storage"> <!-- Name changed simply to avoid name collision with MDM Server -->
        <consistency-rationale></consistency-rationale>
        <f-element id="fau_stg_ext.3.1">
          <title>The MDM Agent shall store MDM audit records in the platform-provided audit storage.</title>
          <note role="application">FAU_STG_EXT.3 shall only be included in the <abbr linkend="ST"/> for MDM Agent platforms (i.e., mobile devices) that conform to Mobile Device Fundamentals Protection Profile version 3.</note>
          <aactivity>
            <TSS/>The evaluator shall verify that the <abbr linkend="TSS"/> description of the audit records indicates how the records are stored. The evaluator shall verify that the Agent calls a platform-provided API to store audit records.
          </aactivity>
        </f-element>
      </f-component>
      </subsection>
      <subsection title="Protection of the TSF (FPT)" id="fpt">
        <f-component id="fpt_net_ext.1" name="Network Reachability">
          <consistency-rationale></consistency-rationale>
          <f-element id="fpt_net_ext.1.1">
            <title>The TSF shall detect when a configurable             
              <selectables>
                <selectable>positive integer of missed reachability events occur</selectable>
                <selectable>time limit is exceeded</selectable>
              </selectables>
              related to the last successful connection with the server has been reached.</title>
            <note role="application">
              This requirement is to enable the Agent to determine if it has been out of connectivity with the Server for too long. The configuration of the number of allowed missed reachability events or time limit since last successful connection with the server is handled in Server configuration policy of the Agent (FMT_SMF.1.1(1) function 56a). If FMT_SMF.1.1(1) function 56a is included in the <abbr linkend="ST"/>, then FPT_NET_EXT.1.1 shall be included in the MDM Server <abbr linkend="ST"/>.<htm:br/><htm:br/>
              If the Agent has been out of connectivity with the server for too long than the remediation actions specified in function 56b shall occur. For example if the Agent has not synced with the server in the allowed amount of time that the Agent shall wipe the device without requiring a command from the Server.
            </note>
            <aactivity>
              <TSS/>
              The evaluator shall verify that the <abbr linkend="TSS"/> contains a description of how the Agent determines how long it has been since the last successful connection with the Server (i.e., total number of missed reachability events or time). If total number of missed reachability events is selected, the evaluator shall verify that the <abbr linkend="TSS"/> contains a description of how often the reachability events are sent.
              <Guidance/>
              The evaluator shall verify that the AGD guidance instructs the administrator, if needed, how to configure the <abbr linkend="TOE"/> to detect when the time since last successful connection with the server has been reached.
              <Tests/>
              The evaluator shall configure the Server configuration policy of the Agent per FMT_SMF.1.1(1) function 56. The device shall be placed in airplane mode to prevent connectivity with the Server. The evaluator shall verify that after the configured time, the remediation actions selected in function 56 occur.
              <testlist>
                <test></test>
                <test></test>
              </testlist>
            </aactivity>
          </f-element>
        </f-component>
      </subsection>
    </obj-sfrs>
  </chapter>

  
  <bibliography>
    <cc-entry/>  
  </bibliography>
 
  
  <acronyms>
    <!-- ToDo: Fix -->
        <entry>
          <term>ADB</term>
          <description>Android Debug Bridge</description>
        </entry>
        <entry>
          <term>AES</term>
          <description>Advanced Encryption Standard</description>
        </entry>
        <entry>
          <term>ANSI</term>
          <description>American National Standards Institute</description>
        </entry>
  </acronyms>
  
</Module>
    
    
    <!-- SCHEMA: Should the SFR notations section also include something for extended
    <htm:li>Extended <abbr linkend="SFR"/>s: are identified by having a label “EXT” after the <abbr linkend="SFR"/> name.</htm:li>
    -->
    
      

      
<!-- May need to add a blurb about the entropy documentation in the SD, Dianne is looking into it. -->
<!--  
  <appendix id="entropy" title="Entropy Documentation and Assessment">
    The <abbr linkend="TOE"/> does not require any additional supplementary information to describe its entropy source(s) beyond the requirements outlined in the ‘Entropy Documentation and Assessment’ sections of the MDF and MDM <abbr linkend="PP"/>s. As with other base <abbr linkend="PP"/> requirements, the only additional requirement is that the entropy documentation also applies to the specific MDM Agent capabilities of the <abbr linkend="TOE"/> in addition to the functionality required by the base <abbr linkend="PP"/>.
  </appendix>
  
  <appendix id="references" title="References">
    <htm:table>
      <htm:tr>
        <htm:th>Identifier</htm:th>
        <htm:th>Title</htm:th>
      </htm:tr>
      <htm:tr>
        <htm:td>[CC]</htm:td>
        <htm:td>
          Common Criteria for Information Technology Security Evaluation –
          <htm:ul>
            
            <htm:li>Part 1: Introduction and General Model, CCMB-2012-09-001, Version 3.1 Revision 4, September 2012</htm:li>
            <htm:li>Part 2: Security Functional Components, CCMB-2012-09-002, Version 3.1 Revision 4, September 2012</htm:li>
            <htm:li>Part 3: Security Assurance Components, CCMB-2012-09-003, Version 3.1 Revision 4, September 2012</htm:li>
          </htm:ul>
        </htm:td>
      </htm:tr>
      <htm:tr>
        <htm:td>[<abbr linkend="CEM"/>]</htm:td>
        <htm:td>Common Methodology for Information Technology Security Evaluation, Evaluation Methodology, CCMB-2012-09-004, Version 3.1 Revision 4, September 2012</htm:td>
      </htm:tr>
      <htm:tr>
        <htm:td>[MDF <abbr linkend="PP"/>]</htm:td>
        <htm:td>Protection Profile for Mobile Device Fundamentals, Version 3.0, June 2016</htm:td>
      </htm:tr>
      <htm:tr>
        <htm:td>[MDM <abbr linkend="PP"/>]</htm:td>
        <htm:td>Protection Profile for Mobile Device Management, Version 3.0, November 2016</htm:td>
      </htm:tr>
    </htm:table>
    <htm:br/><htm:br/>
  </appendix>
  <appendix id="acronyms" title="Acronyms">
    
  </appendix>
  -->
  <!-- Question: Does Module have SARs? -->







